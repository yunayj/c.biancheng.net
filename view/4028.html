<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="renderer" content="webkit" />
<meta name="force-rendering" content="webkit"/>
<meta name="applicable-device" content="pc,mobile" />
<meta name="MobileOptimized" content="width" />
<meta name="HandheldFriendly" content="true" />
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<meta name="format-detection" content="telephone=no" />
<link rel="shortcut icon" href="../favicon.ico" />
<link href="../templets/new/style/common.css" rel="stylesheet" />
<title>Linux sed命令完全攻略（超级详细）</title>
<meta name="description" content="sed 是一款流编辑工具，和普通的交互式文本编辑方式（比如 Vim）不同，在命令执行过程中，我们无法利用键盘命令和鼠标交互式地对数据进行处理，而只能在 sed 处理数据之前，预先给" />
</head>
<body>
<div id="topbar" class="clearfix">
<ul id="product-type" class="left">
<li>
<a href="../c_biancheng_default.html"><span class="iconfont iconfont-home"></span>首页</a>
</li>
<li class="active">
<a href="../sitemap/sitemap_3.html" rel="nofollow"><span class="iconfont iconfont-book"></span>教程</a>
</li>
<li>
<a href="http://vip.biancheng.net/p/vip/show.php" rel="nofollow" target="_blank"><span class="iconfont iconfont-vip"></span>VIP会员</a>
</li>
<li>
<a href="../fudao_biancheng_default.html" rel="nofollow" target="_blank"><span class="iconfont iconfont-fudao"></span>辅导班</a>
</li>
<li>
<a href="niz69i.html" target="_blank"><span class="iconfont iconfont-chip"></span>嵌入式学习路线</a>
</li>
</ul>
</div>
<div id="header" class="clearfix">
<a id="logo" class="left" href="../c_biancheng_default.html">
<img height="26" src="../templets/new/images/logo.png" alt="C语言中文网" />
</a>
<ul id="nav-main" class="hover-none left clearfix">
<li class="wap-yes"><a href="../c_biancheng_default.html">首页</a></li>
<li><a href="../c/c_3.html">C语言教程</a></li>
<li><a href="../cplus/cplus.html">C++教程</a></li>
<li><a href="../python/python.html">Python教程</a></li>
<li><a href="../java/java_3.html">Java教程</a></li>
<li><a href="../linux_tutorial/linux_tutorial.html">Linux入门</a></li>
<li><a href="../sitemap/sitemap_3.html" title="网站地图">更多&gt;&gt;</a></li>
</ul>
<span id="sidebar-toggle" class="toggle-btn" toggle-target="#sidebar">目录 <span class="iconfont"></span></span>
<a href="http://vip.biancheng.net/?from=topbar" class="user-info iconfont iconfont-user hover-none" target="_blank" rel="nofollow" title="用户中心"></a>
</div>
<div id="main" class="clearfix">
<div id="sidebar" class="toggle-target">
<div id="contents">
<dt><span class="iconfont iconfont-list-vertical" aria-hidden="true"></span><a href="../linux_tutorial/linux_tutorial.html">Linux</a></dt>
<dd>
<span class="channel-num">1</span>
<a href='../linux_tutorial/10/10.html'>Linux简介</a>
</dd>
<dd>
<span class="channel-num">2</span>
<a href='../linux_tutorial/20/20.html'>Linux安装</a>
</dd>
<dd>
<span class="channel-num">3</span>
<a href='../linux_tutorial/file_content/file_content.html'>Linux文件和目录管理</a>
</dd>
<dd>
<span class="channel-num">4</span>
<a href='../linux_tutorial/bale_compress/bale_compress.html'>Linux打包（归档）和压缩</a>
</dd>
<dd>
<span class="channel-num">5</span>
<a href='../linux_tutorial/40/40.html'>Vim文本编辑器</a>
</dd>
<dd class="this"> <span class="channel-num">6</span> <a href="../linux_tutorial/text_processing/text_processing.html">Linux文本处理（Linux三剑客）</a> </dd><dl class="dl-sub"><dd>6.1 <a href="728.html">Linux连接合并文件内容(cat命令）</a></dd><dd>6.2 <a href="729.html">Linux分屏显示文件内容（more命令）</a></dd><dd>6.3 <a href="736.html">Linux显示文件开头内容（head命令）</a></dd><dd>6.4 <a href="4004.html">Linux查看文件内容（less命令）</a></dd><dd>6.5 <a href="737.html">Linux显示文件结尾内容（tail命令）</a></dd><dd>6.6 <a href="vip_7660.html">Linux重定向（输入输出重定向）</a><span class="iconfont iconfont-vip2"></span></dd><dd>6.7 <a href="4017.html">Linux grep（Linux三剑客之一）</a></dd><dd>6.8 <a href="4028.html">Linux sed（Linux三剑客之一）</a></dd><dd>6.9 <a href="vip_5063.html">Linux sed命令的高级玩法</a><span class="iconfont iconfont-vip2"></span></dd><dd>6.10 <a href="4082.html">Linux awk（Linux三剑客之一）</a></dd><dd>6.11 <a href="vip_5064.html">Linux awk命令的高级玩法</a><span class="iconfont iconfont-vip2"></span></dd></dl>
<dd>
<span class="channel-num">7</span>
<a href='../linux_tutorial/50/50.html'>Linux软件安装</a>
</dd>
<dd>
<span class="channel-num">8</span>
<a href='../linux_tutorial/60/60.html'>Linux用户和用户组管理</a>
</dd>
<dd>
<span class="channel-num">9</span>
<a href='../linux_tutorial/70/70.html'>Linux权限管理</a>
</dd>
<dd>
<span class="channel-num">10</span>
<a href='../linux_tutorial/80/80.html'>Linux文件系统管理</a>
</dd>
<dd>
<span class="channel-num">11</span>
<a href='../linux_tutorial/90/90.html'>Linux高级文件系统管理</a>
</dd>
<dd>
<span class="channel-num">12</span>
<a href='../linux_tutorial/14/14.html'>Linux系统管理</a>
</dd>
<dd>
<span class="channel-num">13</span>
<a href='../linux_tutorial/17/17.html'>Linux备份与恢复</a>
</dd>
<dd>
<span class="channel-num">14</span>
<a href='../linux_tutorial/13/13.html'>Linux系统服务管理</a>
</dd>
<dd>
<span class="channel-num">15</span>
<a href='../linux_tutorial/15/15.html'>Linux系统日志管理</a>
</dd>
<dd>
<span class="channel-num">16</span>
<a href='../linux_tutorial/12/12.html'>Linux启动管理</a>
</dd>
<dd>
<span class="channel-num">17</span>
<a href='../linux_tutorial/16/16.html'>LAMP环境搭建和LNMP环境搭建</a>
</dd>
<dd>
<span class="channel-num">18</span>
<a href='../linux_tutorial/18/18.html'>SELinux管理</a>
</dd>
</div>
</div>
<div id="article-wrap">
<div id="article">
<div class="arc-info">
<span class="position"><span class="iconfont iconfont-home2"></span> <a href="../c_biancheng_default.html">首页</a> &gt; <a href="../linux_tutorial/linux_tutorial.html">Linux</a> &gt; <a href="../linux_tutorial/text_processing/text_processing.html">Linux文本处理（Linux三剑客）</a></span>
</div>
<div id="ggxc-position-bottom" class="ggxc-box"></div>
<h1>Linux sed命令完全攻略（超级详细）</h1>
<div class="pre-next-page clearfix">&nbsp;</div>
<div id="ggxc-arctop-pc-1" class="ggxc-box"></div>
<div id="arc-body">我们知道，Vim 采用的是交互式文本编辑模式，你可以用键盘命令来交互性地插入、删除或替换数据中的文本。但本节要讲的 sed 命令不同，它采用的是流编辑模式，最明显的特点是，在 sed 处理数据之前，需要预先提供一组规则，sed 会按照此规则来编辑数据。<br />
<br />
sed 会根据脚本命令来处理文本文件中的数据，这些命令要么从命令行中输入，要么存储在一个文本文件中，此命令执行数据的顺序如下：
<ol>
<li>
每次仅读取一行内容；</li>
<li>
根据提供的规则命令匹配并修改数据。注意，sed 默认不会直接修改源文件数据，而是会将数据复制到缓冲区中，修改也仅限于缓冲区中的数据；</li>
<li>
将执行结果输出。</li>
</ol>
当一行数据匹配完成后，它会继续读取下一行数据，并重复这个过程，直到将文件中所有数据处理完毕。<br />
<br />
sed 命令的基本格式如下：<br />
<p class="info-box">
[root@localhost ~]# sed [选项] [脚本命令] 文件名</p>
该命令常用的选项及含义，如表 1 所示。<br />
<br />
<table>
<caption>
表 1 sed 命令常用选项及含义</caption>
<tbody>
<tr>
<th>
选项</th>
<th>
含义</th>
</tr>
<tr>
<td>
-e 脚本命令</td>
<td>
该选项会将其后跟的脚本命令添加到已有的命令中。</td>
</tr>
<tr>
<td>
-f 脚本命令文件</td>
<td>
该选项会将其后文件中的脚本命令添加到已有的命令中。</td>
</tr>
<tr>
<td>
-n</td>
<td>
默认情况下，sed 会在所有的脚本指定执行完毕后，会自动输出处理后的内容，而该选项会屏蔽启动输出，需使用 print 命令来完成输出。</td>
</tr>
<tr>
<td>
-i</td>
<td>
此选项会直接修改源文件，要慎用。</td>
</tr>
</tbody>
</table>
<br />
成功使用 sed 命令的关键在于掌握各式各样的脚本命令及格式，它能帮你定制编辑文件的规则。<br />
<h2>
sed脚本命令</h2>
<h4>
sed s 替换脚本命令</h4>
此命令的基本格式为：
<p class="info-box">
[address]s/pattern/replacement/flags</p>
其中，address 表示指定要操作的具体行，pattern 指的是需要替换的内容，replacement 指的是要替换的新内容。<br />
<p class="info-box">
关于指定具体操作行（address）的用法，这里先不做解释，文章后续会对其做详细介绍。</p>
此命令中常用的 flags 标记如表 2 所示。<br />
<br />
<table>
<caption>
表 2 sed s命令flags标记及功能</caption>
<tbody>
<tr>
<th>
flags 标记</th>
<th>
功能</th>
</tr>
<tr>
<td>
n</td>
<td>
1~512 之间的数字，表示指定要替换的字符串出现第几次时才进行替换，例如，一行中有 3 个 A，但用户只想替换第二个 A，这是就用到这个标记；</td>
</tr>
<tr>
<td>
g</td>
<td>
对数据中所有匹配到的内容进行替换，如果没有 g，则只会在第一次匹配成功时做替换操作。例如，一行数据中有 3 个 A，则只会替换第一个 A；</td>
</tr>
<tr>
<td>
p</td>
<td>
会打印与替换命令中指定的模式匹配的行。此标记通常与 -n 选项一起使用。</td>
</tr>
<tr>
<td>
w file</td>
<td>
将缓冲区中的内容写到指定的 file 文件中；</td>
</tr>
<tr>
<td>
&amp;</td>
<td>
用正则表达式匹配的内容进行替换；</td>
</tr>
<tr>
<td>
\n</td>
<td>
匹配第 n 个子串，该子串之前在 pattern 中用 \(\) 指定。</td>
</tr>
<tr>
<td>
\</td>
<td>
转义（转义替换部分包含：&amp;、\ 等）。</td>
</tr>
</tbody>
</table>
<br />
比如，可以指定 sed 用新文本替换第几处模式匹配的地方：
<p class="info-box">
[root@localhost ~]# sed &#39;s/test/trial/2&#39; data4.txt<br />
This is a test of the trial script.<br />
This is the second test of the trial script.</p>
可以看到，使用数字 2 作为标记的结果就是，sed 编辑器只替换每行中第 2 次出现的匹配模式。<br />
<br />
如果要用新文件替换所有匹配的字符串，可以使用 g 标记：
<p class="info-box">
[root@localhost ~]# sed &#39;s/test/trial/g&#39; data4.txt<br />
This is a trial of the trial script.<br />
This is the second trial of the trial script.</p>
<br />
我们知道，-n 选项会禁止 sed 输出，但 p 标记会输出修改过的行，将二者匹配使用的效果就是只输出被替换命令修改过的行，例如：<br />
<p class="info-box">
[root@localhost ~]# cat data5.txt<br />
This is a test line.<br />
This is a different line.<br />
[root@localhost ~]# sed -n &#39;s/test/trial/p&#39; data5.txt<br />
This is a trial line.</p>
<br />
w 标记会将匹配后的结果保存到指定文件中，比如：
<p class="info-box">
[root@localhost ~]# sed &#39;s/test/trial/w test.txt&#39; data5.txt<br />
This is a trial line.<br />
This is a different line.<br />
[root@localhost ~]#cat test.txt<br />
This is a trial line.</p>
<br />
在使用 s 脚本命令时，替换类似文件路径的字符串会比较麻烦，需要将路径中的正斜线进行转义，例如：<br />
<p class="info-box">
[root@localhost ~]# sed &#39;s/\/bin\/bash/\/bin\/csh/&#39; /etc/passwd</p>
<h4>
sed d 替换脚本命令</h4>
此命令的基本格式为：
<p class="info-box">
[address]d</p>
如果需要删除文本中的特定行，可以用 d 脚本命令，它会删除指定行中的所有内容。但使用该命令时要特别小心，如果你忘记指定具体行的话，文件中的所有内容都会被删除，举个例子：<br />
<p class="info-box">
[root@localhost ~]# cat data1.txt<br />
The quick brown fox jumps over the lazy dog<br />
The quick brown fox jumps over the lazy dog<br />
The quick brown fox jumps over the lazy dog<br />
The quick brown fox jumps over the lazy dog<br />
[root@localhost ~]# sed &#39;d&#39; data1.txt<br />
#什么也不输出，证明成了空文件</p>
当和指定地址一起使用时，删除命令显然能发挥出大的功用。可以从数据流中删除特定的文本行。<br />
<br />
address 的具体写法后续会做详细介绍，这里只给大家举几个简单的例子：
<ul>
<li>
通过行号指定，比如删除 data6.txt 文件内容中的第 3 行：
<p class="info-box">
[root@localhost ~]# cat data6.txt<br />
This is line number 1.<br />
This is line number 2.<br />
This is line number 3.<br />
This is line number 4.<br />
[root@localhost ~]# sed &#39;3d&#39; data6.txt<br />
This is line number 1.<br />
This is line number 2.<br />
This is line number 4.</p>
</li>
<li>
或者通过特定行区间指定，比如删除 data6.txt 文件内容中的第 2、3行：
<p class="info-box">
[root@localhost ~]# sed &#39;2,3d&#39; data6.txt<br />
This is line number 1.<br />
This is line number 4.</p>
</li>
<li>
也可以使用两个文本模式来删除某个区间内的行，但这么做时要小心，你指定的第一个模式会&ldquo;打开&rdquo;行删除功能，第二个模式会&ldquo;关闭&rdquo;行删除功能，因此，sed 会删除两个指定行之间的所有行（包括指定的行），例如：
<p class="info-box">
[root@localhost ~]#sed &#39;/1/,/3/d&#39; data6.txt<br />
#删除第 1~3 行的文本数据<br />
This is line number 4.</p>
</li>
<li>
或者通过特殊的文件结尾字符，比如删除 data6.txt 文件内容中第 3 行开始的所有的内容：
<p class="info-box">
[root@localhost ~]# sed &#39;3,$d&#39; data6.txt<br />
This is line number 1.<br />
This is line number 2.</p>
</li>
</ul>
在此强调，在默认情况下 sed 并不会修改原始文件，这里被删除的行只是从 sed 的输出中消失了，原始文件没做任何改变。<br />
<h4>
sed a 和 i 脚本命令</h4>
a 命令表示在指定行的后面附加一行，i 命令表示在指定行的前面插入一行，这里之所以要同时介绍这 2 个脚本命令，因为它们的基本格式完全相同，如下所示：<br />
<p class="info-box">
[address]a（或 i）\新文本内容</p>
下面分别就这 2 个命令，给读者举几个例子。比如说，将一个新行插入到数据流第三行前，执行命令如下：
<p class="info-box">
[root@localhost ~]# sed &#39;3i\<br />
&gt; This is an inserted line.&#39; data6.txt<br />
This is line number 1.<br />
This is line number 2.<br />
This is an inserted line.<br />
This is line number 3.<br />
This is line number 4.</p>
再比如说，将一个新行附加到数据流中第三行后，执行命令如下：
<p class="info-box">
[root@localhost ~]# sed &#39;3a\<br />
&gt; This is an appended line.&#39; data6.txt<br />
This is line number 1.<br />
This is line number 2.<br />
This is line number 3.<br />
This is an appended line.<br />
This is line number 4.</p>
如果你想将一个多行数据添加到数据流中，只需对要插入或附加的文本中的每一行末尾（除最后一行）添加反斜线即可，例如：
<p class="info-box">
[root@localhost ~]# sed &#39;1i\<br />
&gt; This is one line of new text.\<br />
&gt; This is another line of new text.&#39; data6.txt<br />
This is one line of new text.<br />
This is another line of new text.<br />
This is line number 1.<br />
This is line number 2.<br />
This is line number 3.<br />
This is line number 4.</p>
可以看到，指定的两行都会被添加到数据流中。<br />
<h4>
sed c 替换脚本命令</h4>
c 命令表示将指定行中的所有内容，替换成该选项后面的字符串。该命令的基本格式为：<br />
<p class="info-box">
[address]c\用于替换的新文本</p>
举个例子：
<p class="info-box">
[root@localhost ~]# sed &#39;3c\<br />
&gt; This is a changed line of text.&#39; data6.txt<br />
This is line number 1.<br />
This is line number 2.<br />
This is a changed line of text.<br />
This is line number 4.<br />
在这个例子中，sed 编辑器会修改第三行中的文本，其实，下面的写法也可以实现此目的：<br />
[root@localhost ~]# sed &#39;/number 3/c\<br />
&gt; This is a changed line of text.&#39; data6.txt<br />
This is line number 1.<br />
This is line number 2.<br />
This is a changed line of text.<br />
This is line number 4.</p>
<h4>
sed y 转换脚本命令</h4>
y 转换命令是唯一可以处理单个字符的 sed 脚本命令，其基本格式如下：
<p class="info-box">
[address]y/inchars/outchars/</p>
转换命令会对 inchars 和 outchars 值进行一对一的映射，即 inchars 中的第一个字符会被转换为 outchars 中的第一个字符，第二个字符会被转换成 outchars 中的第二个字符...这个映射过程会一直持续到处理完指定字符。如果 inchars 和 outchars 的长度不同，则 sed 会产生一条错误消息。<br />
<br />
举个简单例子：
<p class="info-box">
[root@localhost ~]# sed &#39;y/123/789/&#39; data8.txt<br />
This is line number 7.<br />
This is line number 8.<br />
This is line number 9.<br />
This is line number 4.<br />
This is line number 7 again.<br />
This is yet another line.<br />
This is the last line in the file.</p>
可以看到，inchars 模式中指定字符的每个实例都会被替换成 outchars 模式中相同位置的那个字符。<br />
<br />
转换命令是一个全局命令，也就是说，它会文本行中找到的所有指定字符自动进行转换，而不会考虑它们出现的位置，再打个比方：
<p class="info-box">
[root@localhost ~]# echo &quot;This 1 is a test of 1 try.&quot; | sed &#39;y/123/456/&#39;<br />
This 4 is a test of 4 try.</p>
sed 转换了在文本行中匹配到的字符 1 的两个实例，我们无法限定只转换在特定地方出现的字符。<br />
<h4>
sed p 打印脚本命令</h4>
p 命令表示搜索符号条件的行，并输出该行的内容，此命令的基本格式为：
<p class="info-box">
[address]p</p>
p 命令常见的用法是打印包含匹配文本模式的行，例如：
<p class="info-box">
[root@localhost ~]# cat data6.txt<br />
This is line number 1.<br />
This is line number 2.<br />
This is line number 3.<br />
This is line number 4.<br />
[root@localhost ~]# sed -n &#39;/number 3/p&#39; data6.txt<br />
This is line number 3.</p>
可以看到，用 -n 选项和 p 命令配合使用，我们可以禁止输出其他行，只打印包含匹配文本模式的行。<br />
<br />
如果需要在修改之前查看行，也可以使用打印命令，比如与替换或修改命令一起使用。可以创建一个脚本在修改行之前显示该行，如下所示：
<p class="info-box">
[root@localhost ~]# sed -n &#39;/3/{<br />
&gt; p<br />
&gt; s/line/test/p<br />
&gt; }&#39; data6.txt<br />
This is line number 3.<br />
This is test number 3.</p>
sed 命令会查找包含数字 3 的行，然后执行两条命令。首先，脚本用 p 命令来打印出原始行；然后它用 s 命令替换文本，并用 p 标记打印出替换结果。输出同时显示了原来的行文本和新的行文本。
<h4>
sed w 脚本命令</h4>
w 命令用来将文本中指定行的内容写入文件中，此命令的基本格式如下：
<p class="info-box">
[address]w filename</p>
这里的 filename 表示文件名，可以使用相对路径或绝对路径，但不管是哪种，运行 sed 命令的用户都必须有文件的写权限。<br />
<br />
下面的例子是将数据流中的前两行打印到一个文本文件中：
<p class="info-box">
[root@localhost ~]# sed &#39;1,2w test.txt&#39; data6.txt<br />
This is line number 1.<br />
This is line number 2.<br />
This is line number 3.<br />
This is line number 4.<br />
[root@localhost ~]# cat test.txt<br />
This is line number 1.<br />
This is line number 2.</p>
当然，如果不想让行直接输出，可以用 -n 选项，再举个例子：
<p class="info-box">
[root@localhost ~]# cat data11.txt<br />
Blum, R&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Browncoat<br />
McGuiness, A&nbsp; Alliance<br />
Bresnahan, C&nbsp; Browncoat<br />
Harken, C&nbsp;&nbsp;&nbsp;&nbsp; Alliance<br />
[root@localhost ~]# sed -n &#39;/Browncoat/w Browncoats.txt&#39; data11.txt<br />
cat Browncoats.txt<br />
Blum, R&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Browncoat<br />
Bresnahan, C&nbsp; Browncoat</p>
可以看到，通过使用 w 脚本命令，sed 可以实现将包含文本模式的数据行写入目标文件。
<h4>
sed r 脚本命令</h4>
r 命令用于将一个独立文件的数据插入到当前数据流的指定位置，该命令的基本格式为：
<p class="info-box">
[address]r filename</p>
sed 命令会将 filename 文件中的内容插入到 address 指定行的后面，比如说：<br />
<p class="info-box">
[root@localhost ~]# cat data12.txt<br />
This is an added line.<br />
This is the second added line.<br />
[root@localhost ~]# sed &#39;3r data12.txt&#39; data6.txt<br />
This is line number 1.<br />
This is line number 2.<br />
This is line number 3.<br />
This is an added line.<br />
This is the second added line.<br />
This is line number 4.</p>
如果你想将指定文件中的数据插入到数据流的末尾，可以使用 $ 地址符，例如：
<p class="info-box">
[root@localhost ~]# sed &#39;$r data12.txt&#39; data6.txt<br />
This is line number 1.<br />
This is line number 2.<br />
This is line number 3.<br />
This is line number 4.<br />
This is an added line.<br />
This is the second added line.</p>
<h4>
sed q 退出脚本命令</h4>
q 命令的作用是使 sed 命令在第一次匹配任务结束后，退出 sed 程序，不再进行对后续数据的处理。<br />
<br />
比如：
<p class="info-box">
[root@localhost ~]# sed &#39;2q&#39; test.txt<br />
This is line number 1.<br />
This is line number 2.</p>
可以看到，sed 命令在打印输出第 2 行之后，就停止了，是 q 命令造成的，再比如：<br />
<p class="info-box">
[root@localhost ~]# sed &#39;/number 1/{ s/number 1/number 0/;q; }&#39; test.txt<br />
This is line number 0.</p>
使用 q 命令之后，sed 命令会在匹配到 number 1 时，将其替换成 number 0，然后直接退出。<br />
<h2>
sed 脚本命令的寻址方式</h2>
前面在介绍各个脚本命令时，我们一直忽略了对 address 部分的介绍。对各个脚本命令来说，address 用来表明该脚本命令作用到文本中的具体行。<br />
<br />
默认情况下，sed 命令会作用于文本数据的所有行。如果只想将命令作用于特定行或某些行，则必须写明 address 部分，表示的方法有以下 2 种：<br />
<ol>
<li>
以数字形式指定行区间；</li>
<li>
用文本模式指定具体行区间。</li>
</ol>
<br />
以上两种形式都可以使用如下这 2 种格式，分别是：
<p class="info-box">
[address]脚本命令<br />
<br />
或者<br />
<br />
address {<br />
&nbsp;&nbsp;&nbsp; 多个脚本命令<br />
}</p>
以上两种形式在前面例子中都有具体实例，因此这里不再做过多赘述。<br />
<h4>
以数字形式指定行区间</h4>
当使用数字方式的行寻址时，可以用行在文本流中的行位置来引用。sed 会将文本流中的第一行编号为 1，然后继续按顺序为接下来的行分配行号。<br />
<br />
在脚本命令中，指定的地址可以是单个行号，或是用起始行号、逗号以及结尾行号指定的一定区间范围内的行。这里举一个 sed 命令作用到指定行号的例子：<br />
<p class="info-box">
[root@localhost ~]#sed &#39;<span style="color:#b22222;">2</span>s/dog/cat/&#39; data1.txt<br />
The quick brown fox jumps over the lazy dog<br />
The quick brown fox jumps over the lazy cat<br />
The quick brown fox jumps over the lazy dog<br />
The quick brown fox jumps over the lazy dog</p>
可以看到，sed 只修改地址指定的第二行的文本。下面的例子中使用了行地址区间：<br />
<p class="info-box">
[root@localhost ~]# sed &#39;<span style="color:#b22222;">2,3</span>s/dog/cat/&#39; data1.txt<br />
The quick brown fox jumps over the lazy dog<br />
The quick brown fox jumps over the lazy cat<br />
The quick brown fox jumps over the lazy cat<br />
The quick brown fox jumps over the lazy dog</p>
在此基础上，如果想将命令作用到文本中从某行开始的所有行，可以用特殊地址&mdash;&mdash;美元符（$）：
<p class="info-box">
[root@localhost ~]# sed &#39;<span style="color:#b22222;">2,$</span>s/dog/cat/&#39; data1.txt<br />
The quick brown fox jumps over the lazy dog<br />
The quick brown fox jumps over the lazy cat<br />
The quick brown fox jumps over the lazy cat<br />
The quick brown fox jumps over the lazy cat</p>
<h4>
用文本模式指定行区间</h4>
sed 允许指定文本模式来过滤出命令要作用的行，格式如下：
<p class="info-box">
/pattern/command</p>
注意，必须用正斜线将要指定的 pattern 封起来，sed 会将该命令作用到包含指定文本模式的行上。<br />
<br />
举个例子，如果你想只修改用户 demo 的默认 shell，可以使用 sed 命令，执行命令如下：
<p class="info-box">
[root@localhost ~]# grep demo /etc/passwd<br />
demo:x:502:502::/home/Samantha:/bin/bash<br />
[root@localhost ~]# sed &#39;/demo/s/bash/csh/&#39; /etc/passwd<br />
root:x:0:0:root:/root:/bin/bash<br />
...<br />
demo:x:502:502::/home/demo:/bin/csh<br />
...</p>
<br />
虽然使用固定文本模式能帮你过滤出特定的值，就跟上面这个用户名的例子一样，但其作用难免有限，因此，sed 允许在文本模式使用正则表达式指明作用的具体行。正则表达式允许创建高级文本模式匹配表达式来匹配各种数据。这些表达式结合了一系列通配符、特殊字符以及固定文本字符来生成能够匹配几乎任何形式文本的简练模式。<br />
<br />
关于正则表达式，本节不做过多介绍，有兴趣的读者可阅读《<a href="http://deerchao.net/tutorials/regex/regex-1.htm" target="_blank">正则表达式入门教程</a>》一文，这里仅给读者提供一个简单示例：
<p class="info-box">
[root@localhost ~]# cat test.txt<br />
&lt;html&gt;<br />
&lt;title&gt;First Wed&lt;/title&gt;<br />
&lt;body&gt;<br />
h1Helloh1<br />
h2Helloh2<br />
h3Helloh3<br />
&lt;/body&gt;<br />
&lt;/html&gt;<br />
#使用正则表示式给所有第一个的h1、h2、h3添加&lt;&gt;，给第二个h1、h2、h3添加&lt;/&gt;<br />
[root@localhost ~]# cat sed.sh<br />
<span style="color:#b22222;">/h[0-9]/{<br />
&nbsp;&nbsp;&nbsp; s//\&lt;&amp;\&gt;/1<br />
&nbsp;&nbsp;&nbsp; s//\&lt;\/&amp;\&gt;/2<br />
}</span><br />
[root@localhost ~]# sed -f sed.sh test.txt<br />
&lt;h1&gt;Hello&lt;/h1&gt;<br />
&lt;h2&gt;Hello&lt;/h2&gt;<br />
&lt;h3&gt;Hello&lt;/h3&gt;</p>
收到篇幅的限制，本节仅介绍了 sed 命令每次只读取一行内容并处理，有关 sed 命令如何一次处理多行文本内容，放到下节继续讲解，读者可点击《<a href="https://c.biancheng.net/view/4056.html" target="_blank">Linux sed命令高级用法</a>》继续学习。</div>
<div id="ggxc-weixin-arcbottom">
<p>关注公众号「<span class="col-green">站长严长生</span>」，在手机上阅读所有教程，随时随地都能学习。内含一款搜索神器，免费下载全网书籍和视频。</p>
<p style="margin-top:12px; text-align:center;">
<img src="../templets/new/images/material/qrcode_mp.png" alt="公众号二维码" width="160" /><br />
<span class="col-green">微信扫码关注公众号</span>
</p>
</div>
<div class="pre-next-page clearfix">&nbsp;</div>
<div id="nice-arcs" class="box-bottom">
<h4>推荐阅读</h4>
<ul class="clearfix">
<li><a href="niz69i_4.html" title="一套完整的嵌入式开发学习路线（高薪就业版）" target="_blank">一套完整的嵌入式开发学习路线（高薪就业版）</a></li>
<li><a href="tnnfqo_2.html" title="一套课程卖1万，TMD太贵了！" target="_blank">一套课程卖1万，TMD太贵了！</a></li>
<li><a href="unnurw_2.html" title="跑了3000公里，见了一位大佬" target="_blank">跑了3000公里，见了一位大佬</a></li>
<li><a href="vip_2106.html" title="malloc函数背后的实现原理——内存池" target="_blank">malloc函数背后的实现原理——内存池</a></li>
<li><a href="8114.html" title="VS Code运行C和C++程序" target="_blank">VS Code运行C和C++程序</a></li>
<li><a href="vip_8518.html" title="GDB如何进行反向调试？" target="_blank">GDB如何进行反向调试？</a></li>
<li><a href="../jsp2/session.html" title="JSP session对象" target="_blank">JSP session对象</a></li>
<li><a href="../python_spider/webpage.html" title="网页是怎样构成的" target="_blank">网页是怎样构成的</a></li>
<li><a href="../python_spider/useragent-pool.html" title="构建User-Agnet代理池" target="_blank">构建User-Agnet代理池</a></li>
<li><a href="../redis/incrby.html" title="Redis INCR数值操作命令" target="_blank">Redis INCR数值操作命令</a></li>
</ul>
</div>
</div>
</div>
</div>
<script type="text/javascript">
// 当前文章ID
window.arcIdRaw = 'a_' + 4028;
window.arcId = "0867R5lvyEC4T8PAba9ttTRbEfml2QzfckjHY7wdGGOOBR1UvNQcCgEm7AI";
window.typeidChain = "290|77";
</script>
<div id="footer" class="clearfix">
<div class="info left">
<p>精美而实用的网站，分享优质编程教程，帮助有志青年。千锤百炼，只为大作；精益求精，处处斟酌；这种教程，看一眼就倾心。</p>
<p>
<a href="8066.html" target="_blank" rel="nofollow">关于网站</a> <span>|</span>
<a href="8092_2.html" target="_blank" rel="nofollow">关于站长</a> <span>|</span>
<a href="8097.html" target="_blank" rel="nofollow">如何完成一部教程</a> <span>|</span>
<a href="9648.html" target="_blank" rel="nofollow">公众号</a> <span>|</span>
<a href="8093.html" target="_blank" rel="nofollow">联系我们</a> <span>|</span>
<a href="../sitemap/sitemap_3.html" target="_blank" rel="nofollow">网站地图</a>
</p>
<p>Copyright ©2012-2022 biancheng.net, <a href="https://beian.miit.gov.cn" target="_blank" rel="nofollow" style="color:#666;">冀ICP备2022013920号</a>, <img height="13" src="../templets/new/images/gongan.png" alt="公安备案图标" /><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=13110202001352" target="_blank" rel="nofollow" style="color:#666;">冀公网安备13110202001352号</a>
</p>
</div>
<img id="logo_bottom" class="right" src="https://c.biancheng.net/templets/new/images/logo_bottom.gif" alt="底部Logo" />
<span id="return-top"><b>↑</b></span>
</div>
<div id="addweixin-widget">
<p>
<script type="text/javascript">
			/*var suffix = 'c';
			var thisMin = (new Date()).getMinutes();
			if(thisMin>=40){
				suffix = 'd';
			}else if(thisMin>=20){
				suffix = 'e';
			}else{
				suffix = 'c';
			}
			document.write('<img src="https://c.biancheng.net/templets/new/images/material/qrcode_wx_'%20+%20suffix%20+'.png?v=1.7.07" alt="微信交流群" width="120" /><br />');*/
		</script>
<img src="../templets/new/images/material/qrcode_mp_2.png" alt="微信交流群" width="120" />
<span>关注微信公众号，加入官方交流群。内含一款搜索神器，免费下载全网书籍和视频。</span>
</p>
<span id="close-addweixin-widget" class="iconfont iconfont-close"></span>
</div>
<script type="text/javascript">
window.siteId = 4;
window.cmsTemplets = "/templets/new";
window.cmsTempletsVer = "1.7.07";
window.prePageURL = "/view/4017.html";
window.nextPageURL = "/view/vip_5063.html";
</script>
<script src="../templets/new/script/jquery1.12.4.min.js"></script>
<script src="https://c.biancheng.net/templets/new/script/common.js"></script>
<span style="display: none;">
<script charset="UTF-8" id="LA_COLLECT" src="https://sdk.51.la/js-sdk-pro.min.js"></script>
<script>LA.init({id:"KDf6QzBhogyQjall",ck:"KDf6QzBhogyQjall",autoTrack:true})</script>
</span>
</body>
</html>