<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="renderer" content="webkit" />
<meta name="force-rendering" content="webkit"/>
<meta name="applicable-device" content="pc,mobile" />
<meta name="MobileOptimized" content="width" />
<meta name="HandheldFriendly" content="true" />
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<meta name="format-detection" content="telephone=no" />
<link rel="shortcut icon" href="../favicon.ico" />
<link href="../templets/new/style/common.css" rel="stylesheet" />
<title>K-means聚类算法的应用以及实现</title>
<meta name="description" content="K-means 聚类算法属于无监督学习，它会将相似的对象归到同一个簇中，该算法原理简单，执行效率高，并且容易实现，是解决聚类问题的经典算法。 尽管如此，任何一款算法都不可能做" />
</head>
<body>
<div id="topbar" class="clearfix">
<ul id="product-type" class="left">
<li>
<a href="../c_biancheng_default.html"><span class="iconfont iconfont-home"></span>首页</a>
</li>
<li class="active">
<a href="../sitemap/sitemap_3.html" rel="nofollow"><span class="iconfont iconfont-book"></span>教程</a>
</li>
<li>
<a href="http://vip.biancheng.net/p/vip/show.php" rel="nofollow" target="_blank"><span class="iconfont iconfont-vip"></span>VIP会员</a>
</li>
<li>
<a href="../fudao_biancheng_default.html" rel="nofollow" target="_blank"><span class="iconfont iconfont-fudao"></span>辅导班</a>
</li>
<li>
<a href="../view/niz69i.html" target="_blank"><span class="iconfont iconfont-chip"></span>嵌入式学习路线</a>
</li>
</ul>
</div>
<div id="header" class="clearfix">
<a id="logo" class="left" href="../c_biancheng_default.html">
<img height="26" src="../templets/new/images/logo.png" alt="C语言中文网" />
</a>
<ul id="nav-main" class="hover-none left clearfix">
<li class="wap-yes"><a href="../c_biancheng_default.html">首页</a></li>
<li><a href="../c/c_3.html">C语言教程</a></li>
<li><a href="../cplus/cplus.html">C++教程</a></li>
<li><a href="../python/python.html">Python教程</a></li>
<li><a href="../java/java_3.html">Java教程</a></li>
<li><a href="../linux_tutorial/linux_tutorial.html">Linux入门</a></li>
<li><a href="../sitemap/sitemap_3.html" title="网站地图">更多&gt;&gt;</a></li>
</ul>
<span id="sidebar-toggle" class="toggle-btn" toggle-target="#sidebar">目录 <span class="iconfont"></span></span>
<a href="http://vip.biancheng.net/?from=topbar" class="user-info iconfont iconfont-user hover-none" target="_blank" rel="nofollow" title="用户中心"></a>
</div>
<div id="main" class="clearfix">
<div id="sidebar" class="toggle-target">
<div id="contents">
<dt><span class="iconfont iconfont-list-vertical" aria-hidden="true"></span><a href="ml_alg.html">机器学习算法</a></dt>
<dd>
<span class="channel-num">1</span>
<a href="what-is-ai.html">什么是人工智能</a>
</dd>
<dd>
<span class="channel-num">2</span>
<a href="term.html">机器学习常用术语</a>
</dd>
<dd>
<span class="channel-num">3</span>
<a href="env.html">机器学习环境搭建</a>
</dd>
<dd>
<span class="channel-num">4</span>
<a href="linear-regression.html">线性回归算法</a>
</dd>
<dd>
<span class="channel-num">5</span>
<a href="linear-model.html">构建线性模型</a>
</dd>
<dd>
<span class="channel-num">6</span>
<a href="hypothesis-loss.html">数学解析线性回归</a>
</dd>
<dd>
<span class="channel-num">7</span>
<a href="gradient-descent.html">梯度下降求极值</a>
</dd>
<dd>
<span class="channel-num">8</span>
<a href="sklearn-linear.html">sklearn实现线性回归</a>
</dd>
<dd>
<span class="channel-num">9</span>
<a href="logistic-regression.html">Logistic回归算法</a>
</dd>
<dd>
<span class="channel-num">10</span>
<a href="analysis-logistic.html">数学解析Logistic算法</a>
</dd>
<dd>
<span class="channel-num">11</span>
<a href="sklearn-logistic.html">应用Logistic回归算法</a>
</dd>
<dd>
<span class="channel-num">12</span>
<a href="knn.html">KNN最邻近分类算法</a>
</dd>
<dd>
<span class="channel-num">13</span>
<a href="sklearn-knn.html">sklearn实现KNN分类算法</a>
</dd>
<dd>
<span class="channel-num">14</span>
<a href="bayes-theorem.html">理解贝叶斯公式</a>
</dd>
<dd>
<span class="channel-num">15</span>
<a href="naive-bayes.html">朴素贝叶斯分类算法原理</a>
</dd>
<dd>
<span class="channel-num">16</span>
<a href="sklearn-bayes.html">朴素贝叶斯算法应用</a>
</dd>
<dd>
<span class="channel-num">17</span>
<a href="decision-tree.html">决策树算法if-else原理</a>
</dd>
<dd>
<span class="channel-num">18</span>
<a href="conditions.html">选择决策树判别条件</a>
</dd>
<dd>
<span class="channel-num">19</span>
<a href="comentropy.html">信息熵是什么</a>
</dd>
<dd>
<span class="channel-num">20</span>
<a href="dcision-cut.html">决策树算法和剪枝原理</a>
</dd>
<dd>
<span class="channel-num">21</span>
<a href="sklearn-decision.html">sklearn决策树分类算法</a>
</dd>
<dd>
<span class="channel-num">22</span>
<a href="svm.html">初识支持向量机SVM分类算法</a>
</dd>
<dd>
<span class="channel-num">23</span>
<a href="linear-indivisibility.html">SVM解决线性不可分问题</a>
</dd>
<dd>
<span class="channel-num">24</span>
<a href="math-svm.html">从数学角度理解SVM分类算法</a>
</dd>
<dd>
<span class="channel-num">25</span>
<a href="svm-application.html">SVM分类算法应用及实现</a>
</dd>
<dd>
<span class="channel-num">26</span>
<a href="what-is-kmeans.html">什么是K-means聚类算法</a>
</dd>
<dd>
<span class="channel-num">27</span>
<a href="kmeans-theory.html">K-means聚类算法原理解析</a>
</dd>
<dd>
<span class="channel-num">28</span>
<a href="kmeans-application.html">K-means聚类算法的应用以及实现</a>
</dd>
<dd>
<span class="channel-num">29</span>
<a href="what-is-ann.html">人工神经网络是什么</a>
</dd>
<dd>
<span class="channel-num">30</span>
<a href="ann-principle.html">神经网络分类算法原理详解</a>
</dd>
<dd>
<span class="channel-num">31</span>
<a href="ann-application.html">神经网络分类算法的应用及其实现</a>
</dd>
<dd>
<span class="channel-num">32</span>
<a href="ensemble-learning.html">什么是集成学习算法</a>
</dd>
<dd>
<span class="channel-num">33</span>
<a href="random-forest.html">集成学习应用：随机森林算法</a>
</dd>
</div>
</div>
<div id="article-wrap">
<div id="article">
<div class="arc-info">
<span class="position"><span class="iconfont iconfont-home2"></span> <a href="../c_biancheng_default.html">首页</a> &gt; <a href="ml_alg.html">机器学习算法</a></span>
</div>
<div id="ggxc-position-bottom" class="ggxc-box"></div>
<h1>K-means聚类算法的应用以及实现</h1>
<div class="pre-next-page clearfix">&nbsp;</div>
<div id="ggxc-arctop-pc-1" class="ggxc-box"></div>
<div id="arc-body">K-means 聚类算法属于无监督学习，它会将相似的对象归到同一个簇中，该算法原理简单，执行效率高，并且容易实现，是解决聚类问题的经典算法。<br />
<br />
尽管如此，任何一款算法都不可能做到完美无瑕，K-measn 算法也有自身的不足之处，比如 K-means 需要通过算术平均数来度量距离，因此数据集的为维度属性必须转换为数值类型，同时 K-means 算法使用随机选择的方式来确定 K 的数量和初始化质心 ，因此不同的随机选择会对最终的分簇结果产生一定程度的影响。
<h2>
算法应用场景</h2>
每一种算法都有各自适用的场景，对于 K-means 算法也不例外，它适合于解决而特征维度为数值型的聚类问题。<br />
<br />
举个简单的例子，一个赛季结束后，篮球队要对队员的整体表现进行聚类分析，此时每位队员的特征维度都是可以量化的，比如某队员的上场时间、得分数、助攻数、失误数等。<br />
<br />
K-means 算法也适用于文本聚类，比如新闻网站会将相同话题的新闻聚集在一起，并自动生成一个个不同话题的新闻专栏，其实这就是利用聚类算法实现的，但是文本的特征维度并非数值类型，因此需要对其进行数值转化操作，将文本数据转换为数学信息，此时可以使用 TF-IDF 加权技术计算单个词的权值。<br />
<p class="tip-box">
TF-IDF 是一种用于信息检索与数据挖掘的常用加权技术。TF 是词频（Term Frequency），IDF 是逆文本频率指数（Inverse Document Frequency）。</p>
下表对 K-means 聚类算法的特点做了简单说明：<br />
<br />
<table>
<tbody>
<tr>
<th>
项目</th>
<th>
内容</th>
</tr>
<tr>
<td>
优点</td>
<td>
原理简单，实现容易，运算效率高。</td>
</tr>
<tr>
<td>
不足</td>
<td>
需要人为设置簇的个数与随机初始化质心点可能影响聚类的最终效果，同时 K-measn 算法对孤立点（离群点）特别敏感，会对最终的聚类结果产生明显扰动。</td>
</tr>
<tr>
<td>
应用领域</td>
<td>
适用于特征维度为数据类型的聚类问题，比如体育赛事等，而对特征维度不是数据类型的需要提前进行转换，比如文本分类等。</td>
</tr>
</tbody>
</table>
<h2>
Sklearn使用K-means算法</h2>
在 Sklearn&nbsp; 机器学习库中，与聚类相关的算法模型都在 cluster 模块下，除 k-measn 外，还有十种聚类最近邻算法，下表对最常用的算法做了简单介绍：<br />
<br />
<table>
<tbody>
<tr>
<th>
类名</th>
<th>
说明</th>
</tr>
<tr>
<td>
KMeans 类</td>
<td>
本节介绍的算法，也是应用最多的聚类算法</td>
</tr>
<tr>
<td>
MiniBatchKMeans 类</td>
<td>
该算法是 K-measn算法变形算法，使用 mini-batch（一种采样数据的思想） 来减少一次聚类所需的计算时间，mini-batch 也是深度学习常使用的方法。</td>
</tr>
<tr>
<td>
DBSCAN 类</td>
<td>
DBNSCAN 算法是一种比较有代表性的基于密度的聚类算法，它的主要思想是将聚类的类视为被低密度区域分割的高密度区域。与划分聚类方法不同，它将簇定义为密度相连的点的最大集合，能够把具有足够高密度的区域划分为簇。</td>
</tr>
<tr>
<td>
MeanShift 类</td>
<td>
MeanShift 算法流程，以任意点作为质心的起点，根据距离均值将质心不断往高密度的地方移动，也即所谓均值漂移，当不满足漂移条件后说明密度已经达到最高，就可以划分成簇。</td>
</tr>
<tr>
<td>
AffinityPropagation 类</td>
<td>
AffinityPropagation 算法（简称 AP 算法），该算法是层次聚类的典型应用，聚类实现过程是一个&ldquo;不断合并同类项&rdquo;的过程，用类似于归纳法思想来完成聚类。</td>
</tr>
</tbody>
</table>
<br />
通过表格不难看出，每一种算法所采用的思想均不相同，但最终都能解决聚类问题，这也是整个聚类算法族的特点之一。<br />
<br />
下面我们对<code>Kmeans.Kmeans()</code>的常用参数做简单介绍：<br />
<br />
<table>
<tbody>
<tr>
<th>
参数</th>
<th>
说明</th>
</tr>
<tr>
<td>
algorithm</td>
<td>
字符串参数值，有三种选择：<br />
1) &quot;auto&quot; ：默认值，自动根据数据值是否稀疏，来决定使用 &quot;full&quot;还是&quot;elkan&quot;，采用默认值即可；<br />
2) &quot;full&quot;：表示使用传统的 K-measn 算法；<br />
3) &quot;elkan&quot;：表示使用 elkan-Means 算法，该算法可以减少不必要的距离计算，加快计算效率。</td>
</tr>
<tr>
<td>
n_cluster</td>
<td>
整型参数，表示分类簇的数量，默认值为 8</td>
</tr>
<tr>
<td>
max_iter</td>
<td>
整型参数，表示最大的迭代次数，默认值为 300</td>
</tr>
<tr>
<td>
n_init</td>
<td>
整型参数，表示用不同的质心初始化值运行算法的次数，默认值为 10</td>
</tr>
<tr>
<td>
init</td>
<td>
字符串参数，有三个可选参数：<br />
1)&quot; k-means++&quot; ，默认值，用一种特殊的方法选定初始质心从而能加速迭代过程的收敛，效果最好；<br />
2) &quot;random&quot; 表示从数据中随机选择 K 个样本作为初始质心点；<br />
3) 提供一个 ndarray 数组，形如 (n_cluster,n_features)，以该数组作为初始质心点。</td>
</tr>
<tr>
<td>
precompute_distance</td>
<td>
有三个可选值，分别是 &quot;auto&quot;, True, False：<br />
1) &quot;auto&quot; ：如果样本数乘以聚类数大于 12 million 的话则不予计算距离；<br />
2) True：总是预先计算距离；<br />
3) False：永远不预先计算距离。</td>
</tr>
<tr>
<td>
tol</td>
<td>
浮点型参数(float)，表示算法收敛的阈值，默认值为 1e-4</td>
</tr>
<tr>
<td>
n_jobs</td>
<td>
整型参数，指定计算所用的进程数量，<br />
1) 若值为 -1，则用所有 CPU 进行运算；<br />
2) 若值为 1 ，则不进行并行运算，方便调试；<br />
3) 若值小于 -1，则用到的 CPU 数为(n_cpus+1+n_jobs)，因此若为 -2 ，则用到的 CPU 数为总 CPU&nbsp;数减去1</td>
</tr>
<tr>
<td>
random_state</td>
<td>
表示随机数生成器的种子，参数值为整形或 numpy.RandomState 类型</td>
</tr>
<tr>
<td>
verbose</td>
<td>
整型参数，默认值为 0，表示不输出日志信息；1 表示每隔一段时间打印一次日志信息；如果大于 1时，打印次数变得频繁。</td>
</tr>
</tbody>
</table>
<br />
最后通过鸢尾花数据集对 K-means 算法进行简单的演示，示例代码如下：
<pre class="python">
import matplotlib.pyplot as plt
import matplotlib
from  sklearn.cluster import KMeans
from sklearn.datasets import load_iris

#设置 matplotlib rc配置文件
matplotlib.rcParams[&#39;font.sans-serif&#39;] = [u&#39;SimHei&#39;] # 用来设置字体样式以正常显示中文标签
matplotlib.rcParams[&#39;axes.unicode_minus&#39;] = False # 设置为 Fasle 来解决负号的乱码问题

# 加载鸢尾花数据集
# 数据的特征分别是 sepal length(花萼长度)、sepal width(花萼宽度)、petal length（花瓣长度）、petal width（花瓣宽度）
iris = load_iris()
X = iris.data[:, :2]  # 通过花萼的两个特征（长度和宽度）来聚类
k = 3  # 假设聚类为 3 类，默认分为 8 个 簇
# 构建算法模型
km = KMeans(n_clusters=k) # n_clusters参数表示分成几个簇（此处k=3）
km.fit(X)

# 获取聚类后样本所属簇的对应编号（label_pred）
label_pred = km.labels_  # labels_属性表示每个点的分簇号，会得到一个关于簇编号的数组
centroids = km.cluster_centers_  #cluster_center 属性用来获取簇的质心点，得到一个关于质心的二维数组，形如[[x1,y1],[x2,y2],[x3,x3]]

# 未聚类前的数据分布图
plt.subplot(121)
plt.scatter(X[:, 0], X[:, 1], s=50)
plt.xlabel(&#39;花萼长度&#39;)
plt.ylabel(&#39;花萼宽度&#39;)
plt.title(&quot;未聚类之前&quot;)
# wspace 两个子图之间保留的空间宽度
plt.subplots_adjust(wspace=0.5) # subplots_adjust（）用于调整边距和子图间距
# 聚类后的分布图
plt.subplot(122)
# c：表示颜色和色彩序列，此处与 cmap 颜色映射一起使用（cool是颜色映射值）s表示散点的的大小，marker表示标记样式（散点样式）
plt.scatter(X[:, 0], X[:, 1], c=label_pred, s=50, cmap=&#39;cool&#39;)
# 绘制质心点
plt.scatter(centroids[:,0],centroids[:,1],c=&#39;red&#39;,marker=&#39;o&#39;,s=100)
plt.xlabel(&#39;花萼长度&#39;)
plt.ylabel(&#39;花萼宽度&#39;)
plt.title(&quot;K-Means算法聚类结果&quot;)
plt.show()</pre>
最终的显示结果如下图所示：<br />
<br />
<div style="text-align: center;">
<img alt="k-means聚类算法" src="../uploads/allimg/220420/1453215c1-0.gif" /></div>
<br />
通过绘图结果可以看出，在没有&ldquo;参考答案&rdquo;的前提下，K-measn 算法完成了样本的分簇任务，其中红色圆点是质心点。
<h2>
总结</h2>
聚类算法博大精深，每一种算法都有自己的实现原理，单拿 K-means 算法来说，就有多种基于它的衍生算法，比如二分 K-means 算法、K-means++ 算法、K-measn|| 算法、Canopy 算法，以及 Mini Batch K-means 算法等，这些算法的出现主要是为了弥补 K-means 算法的不足，比如随机选择初始簇质心点，以及 K 值敏感等问题。<br />
<br />
不过世界上并没有十全十美的算法，因此这些算法也多少存在一些不足之处。如果您对上述提及的算法感兴趣，在掌握 K-means 算法的前提下，不妨自己钻研一下。<br />
</div>
<div id="ggxc-weixin-arcbottom">
<p>关注公众号「<span class="col-green">站长严长生</span>」，在手机上阅读所有教程，随时随地都能学习。内含一款搜索神器，免费下载全网书籍和视频。</p>
<p style="margin-top:12px; text-align:center;">
<img src="../templets/new/images/material/qrcode_mp.png" alt="公众号二维码" width="160" /><br />
<span class="col-green">微信扫码关注公众号</span>
</p>
</div>
<div class="pre-next-page clearfix">&nbsp;</div>
<div id="nice-arcs" class="box-bottom">
<h4>推荐阅读</h4>
<ul class="clearfix">
<li><a href="../view/niz69i_4.html" title="一套完整的嵌入式开发学习路线（高薪就业版）" target="_blank">一套完整的嵌入式开发学习路线（高薪就业版）</a></li>
<li><a href="../view/tnnfqo_2.html" title="一套课程卖1万，TMD太贵了！" target="_blank">一套课程卖1万，TMD太贵了！</a></li>
<li><a href="../view/unnurw_2.html" title="跑了3000公里，见了一位大佬" target="_blank">跑了3000公里，见了一位大佬</a></li>
<li><a href="../view/171.html" title="switch case语句，switch case用法详解" target="_blank">switch case语句，switch case用法详解</a></li>
<li><a href="../view/vip_1797.html" title="进入缓冲区（缓存）的世界，破解一切与输入输出有关的疑难杂症" target="_blank">进入缓冲区（缓存）的世界，破解一切与输入输出有关的疑难杂症</a></li>
<li><a href="../view/vip_2322.html" title="C++模板的显式具体化" target="_blank">C++模板的显式具体化</a></li>
<li><a href="../view/5469.html" title="JS &amp;、|、^和~（逻辑位运算符）" target="_blank">JS &amp;、|、^和~（逻辑位运算符）</a></li>
<li><a href="../view/vip_8341.html" title="SQL注入是什么？SQL注入原理及预防方法" target="_blank">SQL注入是什么？SQL注入原理及预防方法</a></li>
<li><a href="../hibernate/po.html" title="Hibernate持久化类详解" target="_blank">Hibernate持久化类详解</a></li>
<li><a href="../view/9853.html" title="ROS机器人操作系统简介（非常详细）" target="_blank">ROS机器人操作系统简介（非常详细）</a></li>
</ul>
</div>
</div>
</div>
</div>
<script type="text/javascript">
// 当前文章ID
window.arcIdRaw = 'a_' + 9635;
window.arcId = "3e432w2RkajJ4V1dzCo/VS/c3SmgneCsIyuYWuVoTG7oqadWn4Ht4+iaUIk";
window.typeidChain = "427";
</script>
<div id="footer" class="clearfix">
<div class="info left">
<p>精美而实用的网站，分享优质编程教程，帮助有志青年。千锤百炼，只为大作；精益求精，处处斟酌；这种教程，看一眼就倾心。</p>
<p>
<a href="../view/8066.html" target="_blank" rel="nofollow">关于网站</a> <span>|</span>
<a href="../view/8092_2.html" target="_blank" rel="nofollow">关于站长</a> <span>|</span>
<a href="../view/8097.html" target="_blank" rel="nofollow">如何完成一部教程</a> <span>|</span>
<a href="../view/9648.html" target="_blank" rel="nofollow">公众号</a> <span>|</span>
<a href="../view/8093.html" target="_blank" rel="nofollow">联系我们</a> <span>|</span>
<a href="../sitemap/sitemap_3.html" target="_blank" rel="nofollow">网站地图</a>
</p>
<p>Copyright ©2012-2022 biancheng.net, <a href="https://beian.miit.gov.cn" target="_blank" rel="nofollow" style="color:#666;">冀ICP备2022013920号</a>, <img height="13" src="../templets/new/images/gongan.png" alt="公安备案图标" /><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=13110202001352" target="_blank" rel="nofollow" style="color:#666;">冀公网安备13110202001352号</a>
</p>
</div>
<img id="logo_bottom" class="right" src="https://c.biancheng.net/templets/new/images/logo_bottom.gif" alt="底部Logo" />
<span id="return-top"><b>↑</b></span>
</div>
<div id="addweixin-widget">
<p>
<script type="text/javascript">
			/*var suffix = 'c';
			var thisMin = (new Date()).getMinutes();
			if(thisMin>=40){
				suffix = 'd';
			}else if(thisMin>=20){
				suffix = 'e';
			}else{
				suffix = 'c';
			}
			document.write('<img src="https://c.biancheng.net/templets/new/images/material/qrcode_wx_'%20+%20suffix%20+'.png?v=1.7.07" alt="微信交流群" width="120" /><br />');*/
		</script>
<img src="../templets/new/images/material/qrcode_mp_2.png" alt="微信交流群" width="120" />
<span>关注微信公众号，加入官方交流群。内含一款搜索神器，免费下载全网书籍和视频。</span>
</p>
<span id="close-addweixin-widget" class="iconfont iconfont-close"></span>
</div>
<script type="text/javascript">
window.siteId = 4;
window.cmsTemplets = "/templets/new";
window.cmsTempletsVer = "1.7.07";
window.prePageURL = "/ml_alg/kmeans-theory.html";
window.nextPageURL = "/ml_alg/what-is-ann.html";
</script>
<script src="../templets/new/script/jquery1.12.4.min.js"></script>
<script src="https://c.biancheng.net/templets/new/script/common.js"></script>
<span style="display: none;">
<script charset="UTF-8" id="LA_COLLECT" src="https://sdk.51.la/js-sdk-pro.min.js"></script>
<script>LA.init({id:"KDf6QzBhogyQjall",ck:"KDf6QzBhogyQjall",autoTrack:true})</script>
</span>
</body>
</html>