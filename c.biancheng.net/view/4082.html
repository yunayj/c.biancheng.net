<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="renderer" content="webkit" />
<meta name="force-rendering" content="webkit"/>
<meta name="applicable-device" content="pc,mobile" />
<meta name="MobileOptimized" content="width" />
<meta name="HandheldFriendly" content="true" />
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<meta name="format-detection" content="telephone=no" />
<link rel="shortcut icon" href="../favicon.ico" />
<link href="../templets/new/style/common.css" rel="stylesheet" />
<title>Linux awk命令详解</title>
<meta name="description" content="除了使用 sed 命令，Linux 系统中还有一个功能更加强大的文本数据处理工具，就是 awk 。它诞生于 20 世纪 70 年代末期，这也许是它影响了众多 Linux 用户的原因之一。 曾有人推测 awk 命令" />
</head>
<body>
<div id="topbar" class="clearfix">
<ul id="product-type" class="left">
<li>
<a href="../c_biancheng_default.html"><span class="iconfont iconfont-home"></span>首页</a>
</li>
<li class="active">
<a href="../sitemap/sitemap_3.html" rel="nofollow"><span class="iconfont iconfont-book"></span>教程</a>
</li>
<li>
<a href="http://vip.biancheng.net/p/vip/show.php" rel="nofollow" target="_blank"><span class="iconfont iconfont-vip"></span>VIP会员</a>
</li>
<li>
<a href="../fudao_biancheng_default.html" rel="nofollow" target="_blank"><span class="iconfont iconfont-fudao"></span>辅导班</a>
</li>
<li>
<a href="niz69i.html" target="_blank"><span class="iconfont iconfont-chip"></span>嵌入式学习路线</a>
</li>
</ul>
</div>
<div id="header" class="clearfix">
<a id="logo" class="left" href="../c_biancheng_default.html">
<img height="26" src="../templets/new/images/logo.png" alt="C语言中文网" />
</a>
<ul id="nav-main" class="hover-none left clearfix">
<li class="wap-yes"><a href="../c_biancheng_default.html">首页</a></li>
<li><a href="../c/c_3.html">C语言教程</a></li>
<li><a href="../cplus/cplus.html">C++教程</a></li>
<li><a href="../python/python.html">Python教程</a></li>
<li><a href="../java/java_3.html">Java教程</a></li>
<li><a href="../linux_tutorial/linux_tutorial.html">Linux入门</a></li>
<li><a href="../sitemap/sitemap_3.html" title="网站地图">更多&gt;&gt;</a></li>
</ul>
<span id="sidebar-toggle" class="toggle-btn" toggle-target="#sidebar">目录 <span class="iconfont"></span></span>
<a href="http://vip.biancheng.net/?from=topbar" class="user-info iconfont iconfont-user hover-none" target="_blank" rel="nofollow" title="用户中心"></a>
</div>
<div id="main" class="clearfix">
<div id="sidebar" class="toggle-target">
<div id="contents">
<dt><span class="iconfont iconfont-list-vertical" aria-hidden="true"></span><a href="../linux_tutorial/linux_tutorial.html">Linux</a></dt>
<dd>
<span class="channel-num">1</span>
<a href='../linux_tutorial/10/10.html'>Linux简介</a>
</dd>
<dd>
<span class="channel-num">2</span>
<a href='../linux_tutorial/20/20.html'>Linux安装</a>
</dd>
<dd>
<span class="channel-num">3</span>
<a href='../linux_tutorial/file_content/file_content.html'>Linux文件和目录管理</a>
</dd>
<dd>
<span class="channel-num">4</span>
<a href='../linux_tutorial/bale_compress/bale_compress.html'>Linux打包（归档）和压缩</a>
</dd>
<dd>
<span class="channel-num">5</span>
<a href='../linux_tutorial/40/40.html'>Vim文本编辑器</a>
</dd>
<dd class="this"> <span class="channel-num">6</span> <a href="../linux_tutorial/text_processing/text_processing.html">Linux文本处理（Linux三剑客）</a> </dd><dl class="dl-sub"><dd>6.1 <a href="728.html">Linux连接合并文件内容(cat命令）</a></dd><dd>6.2 <a href="729.html">Linux分屏显示文件内容（more命令）</a></dd><dd>6.3 <a href="736.html">Linux显示文件开头内容（head命令）</a></dd><dd>6.4 <a href="4004.html">Linux查看文件内容（less命令）</a></dd><dd>6.5 <a href="737.html">Linux显示文件结尾内容（tail命令）</a></dd><dd>6.6 <a href="vip_7660.html">Linux重定向（输入输出重定向）</a><span class="iconfont iconfont-vip2"></span></dd><dd>6.7 <a href="4017.html">Linux grep（Linux三剑客之一）</a></dd><dd>6.8 <a href="4028.html">Linux sed（Linux三剑客之一）</a></dd><dd>6.9 <a href="vip_5063.html">Linux sed命令的高级玩法</a><span class="iconfont iconfont-vip2"></span></dd><dd>6.10 <a href="4082.html">Linux awk（Linux三剑客之一）</a></dd><dd>6.11 <a href="vip_5064.html">Linux awk命令的高级玩法</a><span class="iconfont iconfont-vip2"></span></dd></dl>
<dd>
<span class="channel-num">7</span>
<a href='../linux_tutorial/50/50.html'>Linux软件安装</a>
</dd>
<dd>
<span class="channel-num">8</span>
<a href='../linux_tutorial/60/60.html'>Linux用户和用户组管理</a>
</dd>
<dd>
<span class="channel-num">9</span>
<a href='../linux_tutorial/70/70.html'>Linux权限管理</a>
</dd>
<dd>
<span class="channel-num">10</span>
<a href='../linux_tutorial/80/80.html'>Linux文件系统管理</a>
</dd>
<dd>
<span class="channel-num">11</span>
<a href='../linux_tutorial/90/90.html'>Linux高级文件系统管理</a>
</dd>
<dd>
<span class="channel-num">12</span>
<a href='../linux_tutorial/14/14.html'>Linux系统管理</a>
</dd>
<dd>
<span class="channel-num">13</span>
<a href='../linux_tutorial/17/17.html'>Linux备份与恢复</a>
</dd>
<dd>
<span class="channel-num">14</span>
<a href='../linux_tutorial/13/13.html'>Linux系统服务管理</a>
</dd>
<dd>
<span class="channel-num">15</span>
<a href='../linux_tutorial/15/15.html'>Linux系统日志管理</a>
</dd>
<dd>
<span class="channel-num">16</span>
<a href='../linux_tutorial/12/12.html'>Linux启动管理</a>
</dd>
<dd>
<span class="channel-num">17</span>
<a href='../linux_tutorial/16/16.html'>LAMP环境搭建和LNMP环境搭建</a>
</dd>
<dd>
<span class="channel-num">18</span>
<a href='../linux_tutorial/18/18.html'>SELinux管理</a>
</dd>
</div>
</div>
<div id="article-wrap">
<div id="article">
<div class="arc-info">
<span class="position"><span class="iconfont iconfont-home2"></span> <a href="../c_biancheng_default.html">首页</a> &gt; <a href="../linux_tutorial/linux_tutorial.html">Linux</a> &gt; <a href="../linux_tutorial/text_processing/text_processing.html">Linux文本处理（Linux三剑客）</a></span>
</div>
<div id="ggxc-position-bottom" class="ggxc-box"></div>
<h1>Linux awk命令详解</h1>
<div class="pre-next-page clearfix">&nbsp;</div>
<div id="ggxc-arctop-pc-1" class="ggxc-box"></div>
<div id="arc-body">除了使用 sed 命令，Linux 系统中还有一个功能更加强大的文本数据处理工具，就是 <span style="color:#008000;">awk</span>。它诞生于 20 世纪 70 年代末期，这也许是它影响了众多 Linux 用户的原因之一。<br />
<p class="info-box">
曾有人推测 awk 命令的名字来源于 awkward 这个单词。其实不然，此命令的设计者有 3 位，他们的姓分别是 Aho、Weingberger 和 Kernighan，awk 就取自这 3 为大师姓的首字母。</p>
和 sed 命令类似，awk 命令也是逐行扫描文件（从第 1 行到最后一行），寻找含有目标文本的行，如果匹配成功，则会在该行上执行用户想要的操作；反之，则不对行做任何处理。<br />
<br />
awk 命令的基本格式为：
<p class="info-box">
[root@localhost ~]# awk [选项] &#39;脚本命令&#39; 文件名</p>
此命令常用的选项以及各自的含义，如表 1 所示。<br />
<br />
<table>
<caption>
表 1 awk 命令选项以及含义</caption>
<tbody>
<tr>
<th>
选项</th>
<th>
含义</th>
</tr>
<tr>
<td>
-F fs</td>
<td>
指定以 fs 作为输入行的分隔符，awk 命令默认分隔符为空格或制表符。</td>
</tr>
<tr>
<td>
-f file</td>
<td>
从脚本文件中读取 awk 脚本指令，以取代直接在命令行中输入指令。</td>
</tr>
<tr>
<td>
-v var=val</td>
<td>
在执行处理过程之前，设置一个变量 var，并给其设备初始值为 val。</td>
</tr>
</tbody>
</table>
<br />
awk 的强大之处在于脚本命令，它由 2 部分组成，分别为匹配规则和执行命令，如下所示：
<p class="info-box">
&#39;匹配规则{执行命令}&#39;</p>
这里的匹配规则，和 sed 命令中的 address 部分作用相同，用来指定脚本命令可以作用到文本内容中的具体行，可以使用字符串（比如 /demo/，表示查看含有 demo 字符串的行）或者正则表达式指定。另外需要注意的是，整个脚本命令是用单引号（&#39;&#39;）括起，而其中的执行命令部分需要用大括号（{}）括起来。<br />
<p class="info-box">
在 awk 程序执行时，如果没有指定执行命令，则默认会把匹配的行输出；如果不指定匹配规则，则默认匹配文本中所有的行。</p>
举个简单的例子：
<p class="info-box">
[root@localhost ~]# awk &#39;/^$/ {print &quot;Blank line&quot;}&#39; test.txt</p>
在此命令中，<code>/^$/</code> 是一个正则表达式，功能是匹配文本中的空白行，同时可以看到，执行命令使用的是 print 命令，此命令经常会使用，它的作用很简单，就是将指定的文本进行输出。因此，整个命令的功能是，如果 test.txt 有 N 个空白行，那么执行此命令会输出 N 个 Blank line。<br />
<h2>
awk 使用数据字段变量</h2>
awk 的主要特性之一是其处理文本文件中数据的能力，它会自动给一行中的每个数据元素分配一个变量。<br />
<br />
默认情况下，awk 会将如下变量分配给它在文本行中发现的数据字段：
<ul>
<li>
$0 代表整个文本行；</li>
<li>
$1 代表文本行中的第 1 个数据字段；</li>
<li>
$2 代表文本行中的第 2 个数据字段；</li>
<li>
$n 代表文本行中的第 n 个数据字段。</li>
</ul>
<br />
前面说过，在 awk 中，默认的字段分隔符是任意的空白字符（例如空格或制表符）。 在文本行中，每个数据字段都是通过字段分隔符划分的。awk 在读取一行文本时，会用预定义的字段分隔符划分每个数据字段。<br />
<br />
所以在下面的例子中，awk 程序读取文本文件，只显示第 1 个数据字段的值：
<p class="info-box">
[root@localhost ~]# cat data2.txt<br />
One line of test text.<br />
Two lines of test text.<br />
Three lines of test text.<br />
[root@localhost ~]# awk &#39;{print $1}&#39; data2.txt<br />
One<br />
Two<br />
Three</p>
该程序用 $1 字段变量来表示&ldquo;仅显示每行文本的第 1 个数据字段&rdquo;。当然，如果你要读取采用了其他字段分隔符的文件，可以用 -F 选项手动指定。<br />
<h2>
awk 脚本命令使用多个命令</h2>
awk 允许将多条命令组合成一个正常的程序。要在命令行上的程序脚本中使用多条命令，只要在命令之间放个分号即可，例如：
<p class="info-box">
[root@localhost ~]# echo &quot;My name is Rich&quot; | awk &#39;{<span style="color:#b22222;">$4=&quot;Christine&quot;; print $0</span>}&#39;<br />
My name is Christine</p>
第一条命令会给字段变量 $4 赋值。第二条命令会打印整个数据字段。可以看到，awk 程序在输出中已经将原文本中的第四个数据字段替换成了新值。<br />
<br />
除此之外，也可以一次一行地输入程序脚本命令，比如说：
<p class="info-box">
[root@localhost ~]# awk &#39;{<br />
&gt; $4=&quot;Christine&quot;<br />
&gt; print $0}&#39;<br />
My name is Rich<br />
My name is Christine</p>
在你用了表示起始的单引号后，bash shell 会使用 &gt; 来提示输入更多数据，我们可以每次在每行加一条命令，直到输入了结尾的单引号。<br />
<p class="info-box">
注意，此例中因为没有在命令行中指定文件名，awk 程序需要用户输入获得数据，因此当运行这个程序的时候，它会一直等着用户输入文本，此时如果要退出程序，只需按下 Ctrl+D 组合键即可。</p>
<h2>
awk从文件中读取程序</h2>
跟 sed 一样，awk 允许将脚本命令存储到文件中，然后再在命令行中引用，比如：
<p class="info-box">
[root@localhost ~]# cat awk.sh<br />
{print $1 &quot;&#39;s home directory is &quot; $6}<br />
[root@localhost ~]# awk -F: <span style="color:#b22222;">-f awk.sh</span> /etc/passwd<br />
root&#39;s home directory is /root<br />
bin&#39;s home directory is /bin<br />
daemon&#39;s home directory is /sbin<br />
adm&#39;s home directory is /var/adm<br />
lp&#39;s home directory is /var/spool/lpd<br />
...<br />
Christine&#39;s home directory is /home/Christine<br />
Samantha&#39;s home directory is /home/Samantha<br />
Timothy&#39;s home directory is /home/Timothy</p>
awk.sh 脚本文件会使用 print 命令打印 /etc/passwd 文件的主目录数据字段（字段变量 $6），以及 userid 数据字段（字段变量 $1）。注意，在程序文件中，也可以指定多条命令，只要一条命令放一行即可，之间不需要用分号。<br />
<h2>
awk BEGIN关键字</h2>
awk 中还可以指定脚本命令的运行时机。默认情况下，awk 会从输入中读取一行文本，然后针对该行的数据执行程序脚本，但有时可能需要在处理数据前运行一些脚本命令，这就需要使用 BEGIN 关键字。<br />
<br />
BEGIN 会强制 awk 在读取数据前执行该关键字后指定的脚本命令，例如：
<p class="info-box">
[root@localhost ~]# cat data3.txt<br />
Line 1<br />
Line 2<br />
Line 3<br />
[root@localhost ~]# awk &#39;BEGIN {print &quot;The data3 File Contents:&quot;}<br />
&gt; {print $0}&#39; data3.txt<br />
The data3 File Contents:<br />
Line 1<br />
Line 2<br />
Line 3</p>
可以看到，这里的脚本命令中分为 2 部分，BEGIN 部分的脚本指令会在 awk 命令处理数据前运行，而真正用来处理数据的是第二段脚本命令。<br />
<h2>
awk END关键字</h2>
和 BEGIN 关键字相对应，END 关键字允许我们指定一些脚本命令，awk 会在读完数据后执行它们，例如：<br />
<p class="info-box">
[root@localhost ~]# awk &#39;BEGIN {print &quot;The data3 File Contents:&quot;}<br />
&gt; {print $0}<br />
&gt; END {print &quot;End of File&quot;}&#39; data3.txt<br />
The data3 File Contents:<br />
Line 1<br />
Line 2<br />
Line 3<br />
End of File</p>
可以看到，当 awk 程序打印完文件内容后，才会执行 END 中的脚本命令。<br />
<p class="info-box">
本节仅介绍了 awk 程序的基本用法，更高级的用法会在下节继续介绍。</p>
</div>
<div id="ggxc-weixin-arcbottom">
<p>关注公众号「<span class="col-green">站长严长生</span>」，在手机上阅读所有教程，随时随地都能学习。内含一款搜索神器，免费下载全网书籍和视频。</p>
<p style="margin-top:12px; text-align:center;">
<img src="../templets/new/images/material/qrcode_mp.png" alt="公众号二维码" width="160" /><br />
<span class="col-green">微信扫码关注公众号</span>
</p>
</div>
<div class="pre-next-page clearfix">&nbsp;</div>
<div id="nice-arcs" class="box-bottom">
<h4>推荐阅读</h4>
<ul class="clearfix">
<li><a href="niz69i_4.html" title="一套完整的嵌入式开发学习路线（高薪就业版）" target="_blank">一套完整的嵌入式开发学习路线（高薪就业版）</a></li>
<li><a href="tnnfqo_2.html" title="一套课程卖1万，TMD太贵了！" target="_blank">一套课程卖1万，TMD太贵了！</a></li>
<li><a href="unnurw_2.html" title="跑了3000公里，见了一位大佬" target="_blank">跑了3000公里，见了一位大佬</a></li>
<li><a href="vip_2108.html" title="C语言内存泄露（内存丢失）" target="_blank">C语言内存泄露（内存丢失）</a></li>
<li><a href="5385.html" title="JavaScript转义字符" target="_blank">JavaScript转义字符</a></li>
<li><a href="../jsp2/usebean.html" title="JSP useBean动作" target="_blank">JSP useBean动作</a></li>
<li><a href="../css3/border-radius.html" title="CSS圆角（border-radius）完全解析" target="_blank">CSS圆角（border-radius）完全解析</a></li>
<li><a href="../hibernate/xxx-hbm-xml.html" title="Hibernate映射文件（Xxx.hbm.xml）" target="_blank">Hibernate映射文件（Xxx.hbm.xml）</a></li>
<li><a href="9644.html" title="为什么中国的996干不过美国的955？" target="_blank">为什么中国的996干不过美国的955？</a></li>
<li><a href="../c/fgets.html" title="C语言fgets()：从文件读取一个字符串" target="_blank">C语言fgets()：从文件读取一个字符串</a></li>
</ul>
</div>
</div>
</div>
</div>
<script type="text/javascript">
// 当前文章ID
window.arcIdRaw = 'a_' + 4082;
window.arcId = "9c10q/RUOJavcT13Er4OhponaeevKsqp2ww593RH8lC2OOBdeiiKYViXxyE";
window.typeidChain = "290|77";
</script>
<div id="footer" class="clearfix">
<div class="info left">
<p>精美而实用的网站，分享优质编程教程，帮助有志青年。千锤百炼，只为大作；精益求精，处处斟酌；这种教程，看一眼就倾心。</p>
<p>
<a href="8066.html" target="_blank" rel="nofollow">关于网站</a> <span>|</span>
<a href="8092_2.html" target="_blank" rel="nofollow">关于站长</a> <span>|</span>
<a href="8097.html" target="_blank" rel="nofollow">如何完成一部教程</a> <span>|</span>
<a href="9648.html" target="_blank" rel="nofollow">公众号</a> <span>|</span>
<a href="8093.html" target="_blank" rel="nofollow">联系我们</a> <span>|</span>
<a href="../sitemap/sitemap_3.html" target="_blank" rel="nofollow">网站地图</a>
</p>
<p>Copyright ©2012-2022 biancheng.net, <a href="https://beian.miit.gov.cn" target="_blank" rel="nofollow" style="color:#666;">冀ICP备2022013920号</a>, <img height="13" src="../templets/new/images/gongan.png" alt="公安备案图标" /><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=13110202001352" target="_blank" rel="nofollow" style="color:#666;">冀公网安备13110202001352号</a>
</p>
</div>
<img id="logo_bottom" class="right" src="https://c.biancheng.net/templets/new/images/logo_bottom.gif" alt="底部Logo" />
<span id="return-top"><b>↑</b></span>
</div>
<div id="addweixin-widget">
<p>
<script type="text/javascript">
			/*var suffix = 'c';
			var thisMin = (new Date()).getMinutes();
			if(thisMin>=40){
				suffix = 'd';
			}else if(thisMin>=20){
				suffix = 'e';
			}else{
				suffix = 'c';
			}
			document.write('<img src="https://c.biancheng.net/templets/new/images/material/qrcode_wx_'%20+%20suffix%20+'.png?v=1.7.07" alt="微信交流群" width="120" /><br />');*/
		</script>
<img src="../templets/new/images/material/qrcode_mp_2.png" alt="微信交流群" width="120" />
<span>关注微信公众号，加入官方交流群。内含一款搜索神器，免费下载全网书籍和视频。</span>
</p>
<span id="close-addweixin-widget" class="iconfont iconfont-close"></span>
</div>
<script type="text/javascript">
window.siteId = 4;
window.cmsTemplets = "/templets/new";
window.cmsTempletsVer = "1.7.07";
window.prePageURL = "/view/vip_5063.html";
window.nextPageURL = "/view/vip_5064.html";
</script>
<script src="../templets/new/script/jquery1.12.4.min.js"></script>
<script src="https://c.biancheng.net/templets/new/script/common.js"></script>
<span style="display: none;">
<script charset="UTF-8" id="LA_COLLECT" src="https://sdk.51.la/js-sdk-pro.min.js"></script>
<script>LA.init({id:"KDf6QzBhogyQjall",ck:"KDf6QzBhogyQjall",autoTrack:true})</script>
</span>
</body>
</html>