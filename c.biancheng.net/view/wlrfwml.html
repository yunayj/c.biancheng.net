<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="renderer" content="webkit" />
<meta name="force-rendering" content="webkit"/>
<meta name="applicable-device" content="pc,mobile" />
<meta name="MobileOptimized" content="width" />
<meta name="HandheldFriendly" content="true" />
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<meta name="format-detection" content="telephone=no" />
<link rel="shortcut icon" href="../favicon.ico" />
<link href="../templets/new/style/common.css" rel="stylesheet" />
<title>Python Selenium库详解</title>
<meta name="description" content="Python支持很多模拟浏览器的库，如 Selenium、Splash、PyV8 等，本节将重点讲解目前最常用的模拟浏览器库 Selenium。 模拟浏览器不同于 urllib 库、requests 库等网络请求库，后者通过伪装浏览器" />
</head>
<body>
<div id="topbar" class="clearfix">
<ul id="product-type" class="left">
<li>
<a href="../c_biancheng_default.html"><span class="iconfont iconfont-home"></span>首页</a>
</li>
<li class="active">
<a href="../sitemap/sitemap_3.html" rel="nofollow"><span class="iconfont iconfont-book"></span>教程</a>
</li>
<li>
<a href="http://vip.biancheng.net/p/vip/show.php" rel="nofollow" target="_blank"><span class="iconfont iconfont-vip"></span>VIP会员</a>
</li>
<li>
<a href="../fudao_biancheng_default.html" rel="nofollow" target="_blank"><span class="iconfont iconfont-fudao"></span>辅导班</a>
</li>
<li>
<a href="niz69i.html" target="_blank"><span class="iconfont iconfont-chip"></span>嵌入式学习路线</a>
</li>
</ul>
</div>
<div id="header" class="clearfix">
<a id="logo" class="left" href="../c_biancheng_default.html">
<img height="26" src="../templets/new/images/logo.png" alt="C语言中文网" />
</a>
<ul id="nav-main" class="hover-none left clearfix">
<li class="wap-yes"><a href="../c_biancheng_default.html">首页</a></li>
<li><a href="../c/c_3.html">C语言教程</a></li>
<li><a href="../cplus/cplus.html">C++教程</a></li>
<li><a href="../python/python.html">Python教程</a></li>
<li><a href="../java/java_3.html">Java教程</a></li>
<li><a href="../linux_tutorial/linux_tutorial.html">Linux入门</a></li>
<li><a href="../sitemap/sitemap_3.html" title="网站地图">更多&gt;&gt;</a></li>
</ul>
<a href="http://vip.biancheng.net/?from=topbar" class="user-info iconfont iconfont-user hover-none" target="_blank" rel="nofollow" title="用户中心"></a>
</div>
<div id="main-no-course" class="clearfix">
<div class="arc-info">
<span class="position"><span class="iconfont iconfont-home2"></span> <a href="../c_biancheng_default.html">首页</a> &gt; 编程笔记</span>
</div>
<div id="ggxc-position-bottom" class="ggxc-box"></div>
<h1>Python Selenium库详解</h1>
<div id="ggxc-arctop-pc-1" class="ggxc-box"></div>
<div id="arc-body">Python支持很多模拟浏览器的库，如 Selenium、Splash、PyV8 等，本节将重点讲解目前最常用的模拟浏览器库 Selenium。<br />
<br />
模拟浏览器不同于 urllib 库、requests 库等网络请求库，后者通过伪装浏览器来爬取网页数据，而模拟浏览器则直接操作浏览器爬取网页数据，因此其优缺点显而易见，优点是无论网站使用了多么复杂且多么精妙的反爬虫技术，使用模拟浏览器都可以根据在 Web 浏览器中所看到的页面进行爬取，缺点是其爬取速度较网络请求库慢很多。<br />
<h2>
Selenium简介</h2>
Selenium 是一款用于 Web 应用程序测试的工具，其最大的特点是&ldquo;Selenium测试直接运行在浏览器中，就像真正的用户在操作一样&rdquo;。此外，Selenium 支持所有主流的浏览器，包括 IE、Firefox、Safari、Chrome、Opera、Edge 等。<br />
<br />
Selenium 自动化测试工具集包括 Selenium 1.0、Selenium 2.0和Selenium 3.0。<br />
<br />
Selenium 1.0 包括 Selenium RC、Selenium IDE 和 Selenium Grid：
<ul>
<li>
Selenium RC，即 Selenium Remote Control，是 Selenium 1.0 的核心部分，可以利用 Selenium 的代理服务器访问浏览器以实现自动化测试，其包括 Client 和 Server 两部分，Client 主要用于实现自动化脚本，而 Server 则负责控制浏览器行为；</li>
<li>
Selenium IDE 是 Firefox 的一个插件，可以用于录制和回放脚本；</li>
<li>
Selenium Grid 主要用于实现分布式测试。</li>
</ul>
<br />
Selenium 2.0 的主要新功能是其集成的 WebDriver，即 Selenium 2.0 可以看作 Selenium 1.0 和 WebDriver 的整合，而 WebDriver 的设计除了解决了一些 Selenium RC 的限制，还提供了一套更加简洁的编程接口，并能更好地支持动态网页。<br />
<br />
此外，在使用 WebDriver 时需要给浏览器安装驱动，例如，Chrome 浏览器的驱动为 ChromeDriver；Firefox 浏览器的驱动为 GeckoDriver；Safari 浏览器的驱动为 SafariDriver 等。<br />
<br />
Selenium 3.0 支持更多的新特性，例如，对 Edge 浏览器和 Safari 浏览器原生驱动的支持，以及开始支持 Firefox 浏览器的 GeckoDriver 驱动，同时废弃了一些基本不用的组件，例如 Selenium RC。
<h2>
Selenium的安装</h2>
Selenium 支持所有主流的浏览器，操作浏览器前需要安装浏览器对应的驱动，具体可登录 <a href="https://www.selenium.dev/documentation/webdriver/getting_started/install_drivers/" target="_blank">Selenium 官网</a>进行下载。<br />
<br />
浏览器对应的驱动下载完成后，需要对该文件进行解压，得到对应的可执行文件，然后将可执行文件移动到 Python 安装目录中的 Scripts 目录中即可。<br />
<br />
此外，Selenium 库属于 Python 的第三方库，所以需要进行安装，只需在命令提示符中输入命令<code>pip install selenium</code>。<br />
<h2>
Selenium的应用</h2>
本节的示例代码均以 Chrome 浏览器为例，其他浏览器的操作参考 Chrome 浏览器即可。<br />
<h4>
1) 打开浏览器</h4>
可以通过 Selenium.webdriver 模块中浏览器所对应的相关方法（如表 1 所示）打开浏览器，并获得 WebDriver 对象。<br />
<br />
<table>
<caption>
表 1 浏览器对应的方法</caption>
<tbody>
<tr>
<th>
浏览器</th>
<th>
方 &nbsp;法</th>
</tr>
<tr>
<td>
Chrome 浏览器</td>
<td>
Chrome()</td>
</tr>
<tr>
<td>
Firefox 浏览器</td>
<td>
Firefox()</td>
</tr>
<tr>
<td>
Edge 浏览器</td>
<td>
Edge()</td>
</tr>
<tr>
<td>
Opera 浏览器</td>
<td>
Opera()</td>
</tr>
<tr>
<td>
Safari 浏览器</td>
<td>
Safari()</td>
</tr>
</tbody>
</table>
示例代码如下：
<pre class="python">
from selenium import webdriver
#创建浏览器WebDriver对象,并打开Chrome浏览器
Chrome_browser=webdriver.Chrome()
print(type(Chrome_browser))</pre>
<h4>
2) 关闭窗口</h4>
可以通过 WebDriver 对象提供的相关方法关闭窗口，具体如下。<br />
<br />
close() 方法用于关闭单个窗口，其语法格式如下：
<pre class="info-box">
close()</pre>
<br />
quit() 方法用于关闭所有窗口，其语法格式如下：
<pre class="info-box">
quit()</pre>
示例代码如下：&nbsp;
<pre class="python">
from selenium import webdriver
import time
#创建浏览器WebDriver对象,并打开Chrome浏览器
Chrome_browser=webdriver.Chrome()
time.sleep(2)
Chrome_browser.quit()</pre>
<h4>
3) 获取网页源代码</h4>
可以通过 WebDriver 对象的相关属性和方法获取网页源代码，具体如下。<br />
<br />
page_source 属性用于获取网页的源代码。<br />
<br />
get() 方法用于访问指定的 URL，其语法格式如下：
<pre class="info-box">
get(url)</pre>
其中，参数 url 表示 URL。<br />
<br />
示例代码如下：
<pre class="python">
from selenium import webdriver
import time
Chrome_browser=webdriver.Chrome()
url=&#39;http://www.oldxia.com/&#39;
Chrome_browser.get(url)
res=Chrome_browser.page_source
with open(&#39;oldxia.html&#39;,&#39;w&#39;,encoding=&#39;utf-8&#39;)as f:
    f.write(res)
time.sleep(2)
Chrome_browser.quit()</pre>
<h4>
4) 获取网页信息</h4>
可以通过 WebDriver 对象的相关属性获取网页信息，具体如下。<br />
<br />
title 属性用于获取当前页面的标题；current_url 用于获取当前页面的 URL。<br />
<br />
示例代码如下：
<pre class="python">
from selenium import webdriver
import time
Chrome_browser=webdriver.Chrome()
url=&#39;http://www.oldxia.com/&#39;
Chrome_browser.get(url)
Chrome_title=Chrome_browser.title
Chrome_current_url=Chrome_browser.current_url
print(Chrome_title)
print(Chrome_current_url)
time.sleep(2)
Chrome_browser.quit()</pre>
<h4>
5) 操作网页</h4>
可以通过 WebDriver 对象的相关方法操作网页，具体如下。<br />
<br />
set_window_size() 方法用于设置浏览器的尺寸，其语法格式如下：
<pre class="info-box">
set_window_size(width,height)</pre>
其中，参数 width 表示浏览器的宽度；参数 height 表示浏览器的高度。<br />
<br />
back() 方法用于控制浏览器后退，其语法格式如下：
<pre class="info-box">
back()</pre>
<br />
forward() 方法用于控制浏览器前进，其语法格式如下：
<pre class="info-box">
forward()</pre>
<br />
refresh() 方法用于刷新当前页面，其语法格式如下：
<pre class="info-box">
refresh()</pre>
<br />
示例代码如下：
<pre class="python">
from selenium import webdriver
import time
Chrome_browser=webdriver.Chrome()
url=&#39;http://www.oldxia.com/&#39;
Chrome_browser.get(url)
Chrome_browser.set_window_size(1000,600)
Chrome_browser.refresh()
Chrome_browser.back()
Chrome_browser.forward()
time.sleep(2)
Chrome_browser.quit()</pre>
<h4>
6)元素定位</h4>
可以通过 WebDriver 对象的相关方法对网页中的元素进行定位。<br />
<br />
find_element() 方法用于获取符合条件的第 1 个元素，并返回一个 WebElement 对象，其语法格式如下：
<pre class="info-box">
find_element(by,value)</pre>
其中，参数 by 表示 selenium.webdriver.common.by 模块中的 By 类，其包括多种元素定位的方式，即 By.ID（id属性）、By.CLASS_NAME（class属性）、By.NAME（name属性）、By.TAG_NAME（标签名）、By.XPATH（XPath）、By.CSS_SELECTOR（CSS选择器）、By.LINK_TEXT（超链接文本内容）、By.CSS_SELECTOR（CSS选择器）、By.LINK_TEXT（超链接文本内容）和By.PARTIAL_LINK_TEXT（部分超链接文本内容）；参数 value 表示元素定位方式所对应的值。<br />
<br />
find_elements() 方法用于获取符合条件的所有元素，并返回一个由 WebElement 对象所组成的列表，其语法格式如下：
<pre class="info-box">
find_elements(by,value)</pre>
其中，参数 by 表示 selenium.webdriver.common.by 模块中的 By 类，其包括多种元素定位的方式，即 By.ID（id属性）、By.CLASS_NAME（class属性）、By.NAME（name属性）、By.TAG_NAME（标签名）、By.XPATH（XPath）、By.CSS_SELECTOR（CSS选择器）、By.LINK_TEXT（超链接文本内容）和 By.PARTIAL_LINK_TEXT（部分超链接文本内容）；参数 value 表示元素定位方式所对应的值。<br />
<br />
示例代码如下：
<pre class="python">
from selenium import webdriver
from selenium.webdriver.common.by import By
import time
Chrome_browser=webdriver.Chrome()
url=&#39;http://www.sina.com.cn/&#39;
Chrome_browser.get(url)
res1=Chrome_browser.find_element(by=By.ID,value=&#39;xy-impcon&#39;)
print(res1)
print(type(res1))
print(&#39;================================&#39;)
res2=Chrome_browser.find_elements(by=By.CLASS_NAME,value=&#39;linkNewsTopBold&#39;)
print(res2)
print(type(res2))
print(&#39;================================&#39;)
res3=Chrome_browser.find_element(by=By.NAME,value=&#39;loginname&#39;)
print(res3)
print(type(res3))
print(&#39;================================&#39;)
res4=Chrome_browser.find_element(by=By.TAG_NAME,value=&#39;input&#39;)
print(res4)
print(type(res4))
print(&#39;================================&#39;)
res5=Chrome_browser.find_element(by=By.XPATH,value=&quot;//div[@id=&#39;SI_Order_B&#39;]&quot;)
print(res5)
print(type(res5))
print(&#39;================================&#39;)
res6=Chrome_browser.find_element(by=By.CSS_SELECTOR,value=&#39;#SI_Order_B&#39;)
print(res6)
print(type(res6))
print(&#39;================================&#39;)
res7=Chrome_browser.find_element(by=By.LINK_TEXT,value=&#39;做大做强数字经济构筑国家竞争
新优势&#39;)
print(res7)
print(type(res7))
print(&#39;================================&#39;)
res8=Chrome_browser.find_element(by=By.PARTIAL_LINK_TEXT,value=&#39;文明之美看东方&#39;)
print(res8)
print(type(res8))
time.sleep(2)
Chrome_browser.quit()</pre>
<h4>
7) 获取元素信息</h4>
可以通过 WebElement 对象的相关属性和方法获取元素信息，具体如下：<br />
<br />
text 属性用于获取元素的文本内容；size 属性用于获取元素的尺寸。<br />
<br />
get_attribute() 方法用于获取元素中指定属性的属性值，其语法格式如下：
<pre class="info-box">
get_attribute(name)</pre>
其中，参数 name 表示元素的属性。<br />
<br />
示例代码如下：
<pre class="python">
from selenium import webdriver
from selenium.webdriver.common.by import By
import time
Chrome_browser=webdriver.Chrome()
url=&#39;https://www.baidu.com/&#39;
Chrome_browser.get(url)
time.sleep(3)
element=Chrome_browser.find_element(by=By.LINK_TEXT,value=&quot;新闻&quot;)
ele_text=element.text
ele_attribute=element.get_attribute(&#39;class&#39;)
ele_size=element.size
print(ele_text)
print(ele_attribute)
print(ele_size)
time.sleep(2)
Chrome_browser.quit()</pre>
<h4>
8) 操作元素</h4>
可以通过 WebElement 对象的 click() 方法单击指定的元素，其语法格式如下：
<pre class="info-box">
click()</pre>
示例代码如下：
<pre class="python">
from selenium import webdriver
from selenium.webdriver.common.by import By
import time
Chrome_browser=webdriver.Chrome()
url=&#39;https://www.baidu.com/&#39;
Chrome_browser.get(url)
time.sleep(3)
element=Chrome_browser.find_element(by=By.LINK_TEXT,value=&quot;新闻&quot;)
element.click()
time.sleep(2)
Chrome_browser.quit()</pre>
<h4>
9) 鼠标事件</h4>
鼠标事件主要用于在网页中模拟鼠标操作。<br />
<br />
在 Selenium 中，关于鼠标事件的相关方法均封装在 selenium.webdriver.common.action_chains 模块中的 ActionChains 类，具体如下。<br />
<br />
ActionChains() 方法主要用于创建 ActionChains 对象，其语法格式如下：
<pre class="info-box">
ActionChains(driver)</pre>
其中，参数 driver 表示 WebDriver 对象。<br />
<br />
move_to_element() 方法主要用于执行鼠标的悬停操作，其语法格式如下：
<pre class="info-box">
move_to_element(to_element)</pre>
其中，参数 to_element 表示 WebElement 对象。<br />
<br />
context_click() 方法主要用于执行鼠标的右击操作，其语法格式如下：
<pre class="info-box">
context_click(on_element)</pre>
其中，参数on_element表示WebElement对象。<br />
<br />
double_click() 方法主要用于执行双击鼠标的左键操作，其语法格式如下：
<pre class="info-box">
double_click(on_element)</pre>
其中，参数 on_element 表示 WebElement 对象。<br />
<br />
perform() 方法用于提交鼠标事件，其语法格式如下：
<pre class="info-box">
perform()</pre>
示例代码如下：
<pre class="python">
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.common.action_chains import ActionChains
import time
Chrome_browser=webdriver.Chrome()
url=&#39;http://www.baidu.com/&#39;
Chrome_browser.get(url)
Chrome_browser.set_window_size(1600,800)
element1=Chrome_browser.find_element(by=By.ID,value=&#39;s-usersetting-top&#39;)
ActionChains(Chrome_browser).move_to_element(element1).perform()
time.sleep(3)
Chrome_browser.refresh()
element2=Chrome_browser.find_element(by=By.LINK_TEXT,value=&quot;图片&quot;)
ActionChains(Chrome_browser).context_click(element2).perform()
time.sleep(3)
Chrome_browser.refresh()
element3=Chrome_browser.find_element(by=By.LINK_TEXT,value=&quot;新闻&quot;)
ActionChains(Chrome_browser).double_click(element3).perform()
time.sleep(2)
Chrome_browser.quit()</pre>
<h4>
10) 键盘事件</h4>
键盘事件主要用于在网页中模拟键盘操作。<br />
<br />
可以通过 WebElement 对象的 send_keys() 方法模拟键盘操作，其语法格式如下：
<pre class="info-box">
send_keys(*value)</pre>
其中，参数 value 既可以表示用户自定义的输入信息，又可以模拟键盘中的按键，而键盘中的按键则需要通过 selenium.webdriver.common.keys 模块中 Keys 类的常量进行表示，其常用的按键如下表所示。<br />
<br />
<table>
<caption>
表 2 键盘中常用的按键</caption>
<tbody>
<tr>
<th>
按 &nbsp;键</th>
<th>
描 &nbsp;述</th>
</tr>
<tr>
<td>
Keys.BACK_SPACE</td>
<td>
Backspace&nbsp;键</td>
</tr>
<tr>
<td>
Keys.SPACE</td>
<td>
空格键</td>
</tr>
<tr>
<td>
Keys.TAB</td>
<td>
Tab 键</td>
</tr>
<tr>
<td>
Keys.ESCAPE</td>
<td>
Esc 键</td>
</tr>
<tr>
<td>
Keys.ENTER</td>
<td>
Enter&nbsp;键</td>
</tr>
<tr>
<td>
Keys.DELETE</td>
<td>
Delete&nbsp;键</td>
</tr>
<tr>
<td>
Keys.CONTROL</td>
<td>
Ctrl 键，可用于组合键</td>
</tr>
<tr>
<td>
Keys. ALT</td>
<td>
Alt 键，可用于组合键</td>
</tr>
<tr>
<td>
Keys.SHIFT</td>
<td>
Shift 键，可用于组合键</td>
</tr>
</tbody>
</table>
示例代码如下：
<pre class="python">
from selenium import webdriver
from selenium.webdriver.common.by import By
import time
Chrome_browser=webdriver.Chrome()
url=&#39;http://www.baidu.com/&#39;
Chrome_browser.get(url)
Chrome_browser.set_window_size(1600,800)
Chrome_browser.find_element(by=By.ID,value=&#39;kw&#39;).send_keys(&#39;老夏学院&#39;)
Chrome_browser.find_element(by=By.ID,value=&#39;su&#39;).click()
time.sleep(2)
Chrome_browser.quit()</pre>
<h4>
11) 切换窗口</h4>
在操作网页的过程中，经常涉及窗口的切换，即当单击网页中的某个链接时，如果新打开了一个窗口，并且需要在该窗口进行相关操作，则此时必须进行窗口切换，因为当前的窗口句柄仍然是链接所在页面的窗口，如果不切换窗口，就无法在新打开的窗口中进行相关操作。<br />
<br />
可以通过 WebDriver 对象中的相关属性切换窗口，具体如下。<br />
<br />
current_window_handle 属性用于获得当前窗口句柄。<br />
<br />
window_handles 属性用于获得当前所有打开的窗口句柄。<br />
<br />
switch_to 属性用于创建 SwitchTo 对象，并通过该对象的 window() 方法切换到指定的窗口，其语法格式如下：
<pre class="info-box">
switch_to.window(window_name)</pre>
其中，参数 window_name 表示窗口句柄。<br />
<br />
示例代码如下：
<pre class="python">
from selenium import webdriver
from selenium.webdriver.common.by import By
import time
Chrome_browser=webdriver.Chrome()
url=&#39;http://www.baidu.com/&#39;
Chrome_browser.get(url)
Chrome_browser.set_window_size(1600,800)
#获得当前的窗口句柄,即&quot;百度首页&quot;
sreach_Windows=Chrome_browser.current_window_handle
Chrome_browser.find_element(by=By.LINK_TEXT,value=&#39;登录&#39;).click()
time.sleep(2)
Chrome_browser.find_element(by=By.LINK_TEXT,value=&quot;立即注册&quot;).click()
time.sleep(2)
#获得当前所有打开的窗口句柄,包括&quot;百度首页&quot;,以及新弹出的窗口&quot;立即注册&quot;
all_handles=Chrome_browser.window_handles
for handle in all_handles:
#如果当前窗口句柄不是&quot;百度首页&quot;,则将窗口切换为&quot;立即注册&quot;
if handle!=sreach_Windows:
Chrome_browser.switch_to.window(handle)
print(&#39;这里是&quot;立即注册&quot;&#39;)
Chrome_browser.find_element(by=By.NAME,value=&quot;userName&quot;).send_keys(&#39;123456789&#39;)
time.sleep(2)
time.sleep(2)
Chrome_browser.quit()</pre>
<h4>
12) 操作警告框、确认框和提示框</h4>
首先，通过 SwitchTo 对象的属性 alert 定位到 JavaScript 所生成的警告框、确认框和提示框，并返回一个 Alert 对象，其语法格式如下：
<pre class="info-box">
alert</pre>
然后，通过 Alert 对象的相关属性和方法即可操作警告框、确认框和提示框。<br />
<br />
text 属性用于获取警告框、确认框或提示框中的文本内容，其语法格式如下：
<pre class="info-box">
text</pre>
<br />
accept() 方法用于接受警告框、确认框和提示框，其语法格式如下：
<pre class="info-box">
accept()</pre>
<br />
dismiss() 方法用于解散警告框、确认框和提示框，其语法格式如下：
<pre class="info-box">
dismiss()</pre>
<br />
send_keys() 方法用于将文本内容发送至提示框，其语法格式如下：
<pre class="info-box">
send_keys(keysToSend)</pre>
其中，参数keysToSend表示待发送的文本内容。<br />
<br />
示例代码如下：
<pre class="python">
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.common.action_chains import ActionChains
import time
Chrome_browser=webdriver.Chrome()
url=&#39;http://www.baidu.com/&#39;
Chrome_browser.get(url)
Chrome_browser.set_window_size(1600,800)
link=Chrome_browser.find_element(by=By.ID,value=&#39;s-usersetting-top&#39;)
ActionChains(Chrome_browser).move_to_element(link).perform()
Chrome_browser.find_element(by=By.LINK_TEXT,value=&quot;搜索设置&quot;).click()
time.sleep(2)
#保存设置
Chrome_browser.find_element(by=By.CLASS_NAME,value=&quot;prefpanelgo&quot;).click()
time.sleep(2)
print(Chrome_browser.switch_to.alert.text)
Chrome_browser.switch_to.alert.accept()
time.sleep(2)
Chrome_browser.quit()</pre>
<h4>
13) 操作下拉菜单</h4>
可以通过 selenium.webdriver.support.select 模块中 Select 类的相关方法操作下拉菜单，具体如下。<br />
<br />
select_by_value() 方法通过 select 标签中 value 属性的属性值操作下拉菜单，其语法格式如下：
<pre class="info-box">
select_by_value(value)</pre>
其中，参数 value 表示 select 标签中 value 属性的属性值。<br />
<br />
select_by_index() 方法通过下拉菜单中的选项索引值操作下拉菜单，其语法格式如下：
<pre class="info-box">
select_by_index(index)</pre>
其中，参数 index 表示下拉菜单中的选项索引值。<br />
<br />
select_by_visible_text() 方法通过 select 标签中 option 标签的文本内容操作下拉菜单，其语法格式如下：
<pre class="info-box">
select_by_visible_text(text)</pre>
其中，参数 text 表示 select 标签中 option 标签的文本内容。<br />
<br />
示例代码如下：
<pre class="python">
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.select import Select
import time
Chrome_browser=webdriver.Chrome()
url=&#39;http://www.oldxia.com/selenium.html&#39;
Chrome_browser.get(url)
time.sleep(3)
sel=Chrome_browser.find_element(by=By.NAME,value=&quot;city&quot;)
Select(sel).select_by_visible_text(&#39;大连&#39;)
time.sleep(2)
Chrome_browser.quit()</pre>
<h4>
14) 上传文件</h4>
可以通过 WebElement 对象的 send_keys() 方法操作 input 标签上传文件，其语法格式如下：
<pre class="info-box">
send_keys(*value)</pre>
其中，参数value表示待上传文件的路径。<br />
<br />
示例代码如下：
<pre class="python">
from selenium import webdriver
from selenium.webdriver.common.by import By
import time
Chrome_browser=webdriver.Chrome()
url=&#39;http://www.oldxia.com/selenium.html&#39;
Chrome_browser.get(url)
time.sleep(3)
Chrome_browser.find_element(by=By.NAME,value=&quot;file&quot;).send_keys(&#39;E:\Python全栈开发\
selenium.txt&#39;)
time.sleep(2)
Chrome_browser.quit()</pre>
<h4>
15) 管理Cookie</h4>
可以通过 WebDriver 对象的相关方法管理 Cookie，具体如下。<br />
<br />
get_Cookies() 方法用于获取所有 Cookie 信息，其语法格式如下：
<pre class="info-box">
get_Cookies()</pre>
<br />
get_Cookie() 方法用于获取指定名称的 Cookie 信息，其语法格式如下：
<pre class="info-box">
get_Cookie(name)</pre>
其中，参数 name 表示 Cookie 的名称。<br />
<br />
add_Cookie() 方法用于添加 Cookie 信息，其语法格式如下：
<pre class="info-box">
add_Cookie(Cookie_dict)</pre>
其中，参数 Cookie_dict 表示字典，并且必须具有 name 键和 value 键。<br />
<br />
delete_Cookie() 方法用于删除指定的 Cookie 信息，其语法格式如下：
<pre class="info-box">
delete_Cookie(name)</pre>
其中，参数 name 表示待删除的 Cookie 名称。<br />
<br />
delete_all_Cookies() 方法用于删除所有 Cookie 信息，其语法格式如下：
<pre class="info-box">
delete_all_Cookies()</pre>
<br />
示例代码如下：
<pre class="python">
from selenium import webdriver
import time
Chrome_browser=webdriver.Chrome()
url=&#39;https://www.baidu.com&#39;
Chrome_browser.get(url)
print(&#39;=====================================&#39;)
print(&quot;所有的Cookie信息:&quot;)
print(Chrome_browser.get_Cookies())
print(&#39;=====================================&#39;)
dict={&#39;name&#39;:&quot;name&quot;,&#39;value&#39;:&#39;夏正东&#39;}
Chrome_browser.add_Cookie(dict)
print(&#39;添加的Cookie信息:&#39;)
print(Chrome_browser.get_Cookie(&#39;name&#39;))
print(&#39;=====================================&#39;)
Chrome_browser.delete_Cookie(&#39;name&#39;)
print(&#39;删除名称为name的Cookie后,所有的Cookie信息:&#39;)
num=0
forCookie in Chrome_browser.get_Cookies():
    print(f&quot;{Cookie[&#39;name&#39;]}&mdash;&mdash;{Cookie[&#39;value&#39;]}&quot;)
    num+=1
print(f&#39;共有{num}条Cookie信息&#39;)
print(&#39;=====================================&#39;)
print(&#39;删除所有Cookie信息:&#39;)
Chrome_browser.delete_all_Cookies()
num=0
forCookie in Chrome_browser.get_Cookies():
    print(f&quot;{Cookie[&#39;name&#39;]}&mdash;&mdash;{Cookie[&#39;value&#39;]}&quot;)
    num+=1
print(f&#39;共有{num}条Cookie信息&#39;)
print(&#39;=====================================&#39;)
time.sleep(2)
Chrome_browser.quit()</pre>
<h4>
16) 控制滚动条</h4>
在 Selenium 中，没有提供相关的属性或方法用于控制滚动条。在这种情况下，可以首先使用 JavaScript 控制滚动条，然后使用 WebDriver 对象提供的 execute_script() 方法来执行 JavaScript 代码即可，其语法格式如下：
<pre class="info-box">
execute_script(script)</pre>
其中，参数 script 表示 JavaScript 代码，示例代码如下：<br />
<pre class="python">
from selenium import webdriver
from selenium.webdriver.common.by import By
import time
Chrome_browser = webdriver.Chrome()
url= &#39;http://www.baidu.com/&#39;
Chrome_browser.get(url)
Chrome_browser.set_window_size(1600, 800)
Chrome_browser.find_element(by = By.ID, value = &quot;kw&quot;).send_keys(&quot;老夏学院&quot;)\
Chrome_browser.find_e1ement(by = By.ID, value = &quot;su&quot;).click()
time.sleep(2)
i= 0
while i &lt; 300 :
time.sleep(2)
js = f&quot;window.scrollTo({i},{i} + 100);&quot;
Chrome_browser.execute_script(js)
i += 100
time.sleep(2)
Chrome_browser.quit()</pre>
<h4>
17) 窗口截图</h4>
可以通过 WebDriver 对象提供的 get_screenshot_as_file()方法进行窗口截图，其语法格式如下：
<pre class="info-box">
get_screenshot_as_file(filename)</pre>
其中，参数 filename 表示图片存储的路径，示例代码如下：
<pre class="python">
from selenium import webdriver
from selenium.webdriver.common.by import By
import time
Chrome_browser=webdriver.Chrome()
url=&#39;http://www.baidu.com/&#39;
Chrome_browser.get(url)
Chrome_browser.set_window_size(1600,800)
Chrome_browser.find_element(by=By.ID,value=&quot;kw&quot;).send_keys(&quot;老夏学院&quot;)
Chrome_browser.find_element(by=By.ID,value=&quot;su&quot;).click()
time.sleep(2)
Chrome_browser.get_screenshot_as_file(&quot;E:\Python全栈开发\selenium.png&quot;)
time.sleep(2)
Chrome_browser.quit()</pre>
<h4>
18) Chrome无界面浏览器</h4>
之前所应用的 Selenium，都是直接操作有界面的浏览器，这就势必会影响爬取数据的速度，而为了尽可能地提高爬取数据的速度，则可以使用 Chrome 无界面浏览器进行数据的爬取，其步骤如下：<br />
<br />
首先，通过 selenium.webdriver.chrome.options 中的 Options 类创建 Options 对象，用于操作 Chrome 无界面浏览器。<br />
<br />
其次，使用 Options 对象的 add_argument() 方法启动参数配置，并将该方法中的参数 argument 的值设置为&ldquo;&mdash;headless&rdquo;，表示使用无界面浏览器。<br />
<br />
最后，在使用 Chrome 类创建 WebDriver 对象时设置参数 options，并且该参数对应的值需为之前所创建的 Options 对象。<br />
<br />
示例代码如下：
<pre class="python">
from selenium import webdriver
from selenium.webdriver.chrome.options import Options
Chrome_options=Options()
Chrome_options.add_argument(argument=&#39;--headless&#39;)
Chrome_browser=webdriver.Chrome(options=Chrome_options)
url=&#39;http://www.oldxia.com/&#39;
Chrome_browser.get(url)
Chrome_browser.get_screenshot_as_file(&#39;oldxia.png&#39;)
Chrome_browser.quit()</pre>
</div>
<div id="ggxc-weixin-arcbottom">
<p>关注公众号「<span class="col-green">站长严长生</span>」，在手机上阅读所有教程，随时随地都能学习。内含一款搜索神器，免费下载全网书籍和视频。</p>
<p style="margin-top:12px; text-align:center;">
<img src="../templets/new/images/material/qrcode_mp.png" alt="公众号二维码" width="160" /><br />
<span class="col-green">微信扫码关注公众号</span>
</p>
</div>
<div id="nice-arcs" class="box-bottom">
<h4>推荐阅读</h4>
<ul class="clearfix">
<li><a href="niz69i_4.html" title="一套完整的嵌入式开发学习路线（高薪就业版）" target="_blank">一套完整的嵌入式开发学习路线（高薪就业版）</a></li>
<li><a href="tnnfqo_2.html" title="一套课程卖1万，TMD太贵了！" target="_blank">一套课程卖1万，TMD太贵了！</a></li>
<li><a href="unnurw_2.html" title="跑了3000公里，见了一位大佬" target="_blank">跑了3000公里，见了一位大佬</a></li>
<li><a href="1048.html" title="Linux系统服务及其分类" target="_blank">Linux系统服务及其分类</a></li>
<li><a href="1282.html" title="Java是什么？Java的特点有哪些？" target="_blank">Java是什么？Java的特点有哪些？</a></li>
<li><a href="../mysql/replace.html" title="MySQL REPLACE函数：字符串替换" target="_blank">MySQL REPLACE函数：字符串替换</a></li>
<li><a href="3368.html" title="数组的顺序存储（C语言版）" target="_blank">数组的顺序存储（C语言版）</a></li>
<li><a href="rqnho6.html" title="Python类方法、类实例方法和静态方法的区别" target="_blank">Python类方法、类实例方法和静态方法的区别</a></li>
<li><a href="bbwr1wr.html" title="Vue和React、Angular的综合对比" target="_blank">Vue和React、Angular的综合对比</a></li>
<li><a href="dtr258p.html" title="《Web前端设计基础（第2版）》PDF下载（高清完整版）" target="_blank">《Web前端设计基础（第2版）》PDF下载（高清完整版）</a></li>
</ul>
</div>
</div>
<script type="text/javascript">
// 当前文章ID
window.arcIdRaw = 'a_' + 10407;
window.arcId = "f908Fq3kKy41RlcSGuWRf+X0kcyDu+9ctRwbiVl+MSzthgQf0DdoB6R2pOS/";
window.typeidChain = "145|119";
</script>
<div id="footer" class="clearfix">
<div class="info left">
<p>精美而实用的网站，分享优质编程教程，帮助有志青年。千锤百炼，只为大作；精益求精，处处斟酌；这种教程，看一眼就倾心。</p>
<p>
<a href="8066.html" target="_blank" rel="nofollow">关于网站</a> <span>|</span>
<a href="8092_2.html" target="_blank" rel="nofollow">关于站长</a> <span>|</span>
<a href="8097.html" target="_blank" rel="nofollow">如何完成一部教程</a> <span>|</span>
<a href="9648.html" target="_blank" rel="nofollow">公众号</a> <span>|</span>
<a href="8093.html" target="_blank" rel="nofollow">联系我们</a> <span>|</span>
<a href="../sitemap/sitemap_3.html" target="_blank" rel="nofollow">网站地图</a>
</p>
<p>Copyright ©2012-2022 biancheng.net, <a href="https://beian.miit.gov.cn" target="_blank" rel="nofollow" style="color:#666;">冀ICP备2022013920号</a>, <img height="13" src="../templets/new/images/gongan.png" alt="公安备案图标" /><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=13110202001352" target="_blank" rel="nofollow" style="color:#666;">冀公网安备13110202001352号</a>
</p>
</div>
<img id="logo_bottom" class="right" src="https://c.biancheng.net/templets/new/images/logo_bottom.gif" alt="底部Logo" />
<span id="return-top"><b>↑</b></span>
</div>
<div id="addweixin-widget">
<p>
<script type="text/javascript">
			/*var suffix = 'c';
			var thisMin = (new Date()).getMinutes();
			if(thisMin>=40){
				suffix = 'd';
			}else if(thisMin>=20){
				suffix = 'e';
			}else{
				suffix = 'c';
			}
			document.write('<img src="https://c.biancheng.net/templets/new/images/material/qrcode_wx_'%20+%20suffix%20+'.png?v=1.7.07" alt="微信交流群" width="120" /><br />');*/
		</script>
<img src="../templets/new/images/material/qrcode_mp_2.png" alt="微信交流群" width="120" />
<span>关注微信公众号，加入官方交流群。内含一款搜索神器，免费下载全网书籍和视频。</span>
</p>
<span id="close-addweixin-widget" class="iconfont iconfont-close"></span>
</div>
<script type="text/javascript">
window.siteId = 4;
window.cmsTemplets = "/templets/new";
window.cmsTempletsVer = "1.7.07";

</script>
<script src="../templets/new/script/jquery1.12.4.min.js"></script>
<script src="https://c.biancheng.net/templets/new/script/common.js"></script>
<span style="display: none;">
<script charset="UTF-8" id="LA_COLLECT" src="https://sdk.51.la/js-sdk-pro.min.js"></script>
<script>LA.init({id:"KDf6QzBhogyQjall",ck:"KDf6QzBhogyQjall",autoTrack:true})</script>
</span>
</body>
</html>